<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Gradually bringing in over stuff from first pipeline. ETF flow decompositions pipeline but querying data from arcticdb.">

<title>lobster-tools - ETF Pipeline2 using s3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="lobster-tools - ETF Pipeline2 using s3">
<meta property="og:description" content="Gradually bringing in over stuff from first pipeline. ETF flow decompositions pipeline but querying data from arcticdb.">
<meta property="og:image" content="https://n-petit.github.io/lobster-tools/06_etf_pipeline_s3_files/figure-html/cell-8-output-2.png">
<meta property="og:site-name" content="lobster-tools">
<meta property="og:image:height" content="418">
<meta property="og:image:width" content="569">
<meta name="twitter:title" content="lobster-tools - ETF Pipeline2 using s3">
<meta name="twitter:description" content="Gradually bringing in over stuff from first pipeline. ETF flow decompositions pipeline but querying data from arcticdb.">
<meta name="twitter:image" content="https://n-petit.github.io/lobster-tools/06_etf_pipeline_s3_files/figure-html/cell-8-output-2.png">
<meta name="twitter:image-height" content="418">
<meta name="twitter:image-width" content="569">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">lobster-tools</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-help" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Help</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-help">    
        <li>
    <a class="dropdown-item" href="https://lobsterdata.com/" rel="" target=""><i class="bi bi-database-fill" role="img">
</i> 
 <span class="dropdown-text">Access Lobster Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/n-petit/lobster-tools/issues" rel="" target=""><i class="bi bi-bug" role="img">
</i> 
 <span class="dropdown-text">Report an Issue</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/n-petit/lobster-tools" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./etf_pipeline_s3.html">ETF Pipeline2 using s3</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./config.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Config</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preprocessing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./flow_decomposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ETF flow decomposition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_downloading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data downloading</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arctic_cli.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ArcticDB CLI</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./etf_pipeline_s3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">ETF Pipeline2 using s3</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#equity-data" id="toc-equity-data" class="nav-link active" data-scroll-target="#equity-data">Equity data</a></li>
  <li><a href="#quick_marginalize" id="toc-quick_marginalize" class="nav-link" data-scroll-target="#quick_marginalize">quick_marginalize</a></li>
  <li><a href="#poolprocess-for-many-dates" id="toc-poolprocess-for-many-dates" class="nav-link" data-scroll-target="#poolprocess-for-many-dates">PoolProcess for many dates</a>
  <ul class="collapse">
  <li><a href="#load-with-arcticdb" id="toc-load-with-arcticdb" class="nav-link" data-scroll-target="#load-with-arcticdb">Load with ArcticDB</a></li>
  <li><a href="#data-analysis" id="toc-data-analysis" class="nav-link" data-scroll-target="#data-analysis">Data analysis</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/n-petit/lobster-tools/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ETF Pipeline2 using s3</h1>
</div>

<div>
  <div class="description">
    Gradually bringing in over stuff from first pipeline. ETF flow decompositions pipeline but querying data from arcticdb.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cfg <span class="op">=</span> get_config(overrides<span class="op">=</span>Overrides.full_server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>directory_path <span class="op">=</span> cfg.data_config.csv_files_path</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>etfs <span class="op">=</span> cfg.universe.etfs</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>equities <span class="op">=</span> cfg.universe.equities</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>markouts <span class="op">=</span> cfg.hyperparameters.markouts</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>finest_resample <span class="op">=</span> cfg.hyperparameters.finest_resample</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>max_markout <span class="op">=</span> cfg.hyperparameters.max_markout</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>date_range <span class="op">=</span> dt.date(<span class="dv">2021</span>, <span class="dv">1</span>, <span class="dv">6</span>), dt.datetime(<span class="dv">2021</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">16</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># temp</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>etfs <span class="op">=</span> [<span class="st">"SPY"</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>equities <span class="op">=</span> etf_to_equities[<span class="st">"SPY"</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>tolerances <span class="op">=</span> [<span class="st">"250us"</span>, <span class="st">"500us"</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>markouts <span class="op">=</span> [<span class="st">"30S"</span>, <span class="st">"1min"</span>, <span class="st">"2min"</span>, <span class="st">"4min"</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>finest_resample <span class="op">=</span> <span class="st">"30S"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>max_markout <span class="op">=</span> <span class="st">"4min"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> NASDAQExchange().trading_days</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="equity-data" class="level3">
<h3 class="anchored" data-anchor-id="equity-data">Equity data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_database_connection(arctic: Arctic) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Test connection to s3 arcticdb database by connecting to the '2021' library and reading the symbol 'FLIR'."</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    available_libraries <span class="op">=</span> arctic.list_libraries()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"available libraries: </span><span class="sc">{</span>available_libraries<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    ticker, library <span class="op">=</span> <span class="st">"FLIR"</span>, <span class="st">"2021"</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> library <span class="kw">in</span> available_libraries</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> ticker <span class="kw">in</span> arctic[library]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    date_range <span class="op">=</span> (dt.datetime(<span class="dv">2021</span>, <span class="dv">1</span>, <span class="dv">1</span>), dt.datetime(<span class="dv">2021</span>, <span class="dv">1</span>, <span class="dv">8</span>))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> arctic[library].read(symbol<span class="op">=</span>ticker, date_range<span class="op">=</span>date_range).data</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"data.head() for ticker=</span><span class="sc">{</span>ticker<span class="sc">}</span><span class="ss">, date_range=</span><span class="sc">{</span>date_range<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    display(df.head())</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>arctic <span class="op">=</span> Arctic(<span class="st">"s3://163.1.179.45:9100:lobster?access=minioadmin&amp;secret=minioadmin"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> test_database_connection(arctic<span class="op">=</span>arctic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>available libraries: ['2021', 'demo', 'testa']
data.head() for ticker=FLIR, date_range=(datetime.datetime(2021, 1, 1, 0, 0), datetime.datetime(2021, 1, 8, 0, 0))</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th">order_id</th>
<th data-quarto-table-cell-role="th">size</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">direction</th>
<th data-quarto-table-cell-role="th">ask_price_1</th>
<th data-quarto-table-cell-role="th">ask_size_1</th>
<th data-quarto-table-cell-role="th">bid_price_1</th>
<th data-quarto-table-cell-role="th">bid_size_1</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">bid_price_8</th>
<th data-quarto-table-cell-role="th">bid_size_8</th>
<th data-quarto-table-cell-role="th">ask_price_9</th>
<th data-quarto-table-cell-role="th">ask_size_9</th>
<th data-quarto-table-cell-role="th">bid_price_9</th>
<th data-quarto-table-cell-role="th">bid_size_9</th>
<th data-quarto-table-cell-role="th">ask_price_10</th>
<th data-quarto-table-cell-role="th">ask_size_10</th>
<th data-quarto-table-cell-role="th">bid_price_10</th>
<th data-quarto-table-cell-role="th">bid_size_10</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:30:00.082945826</td>
<td>34200.082946</td>
<td>6</td>
<td>-1</td>
<td>114046</td>
<td>53.04</td>
<td>0</td>
<td>53.40</td>
<td>30.0</td>
<td>53.0</td>
<td>102.0</td>
<td>...</td>
<td>52.12</td>
<td>20.0</td>
<td>53.98</td>
<td>100.0</td>
<td>52.06</td>
<td>30.0</td>
<td>54.00</td>
<td>114.0</td>
<td>52.0</td>
<td>1702.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:30:00.082945826</td>
<td>34200.082946</td>
<td>1</td>
<td>5746542</td>
<td>100</td>
<td>53.00</td>
<td>1</td>
<td>53.40</td>
<td>30.0</td>
<td>53.0</td>
<td>202.0</td>
<td>...</td>
<td>52.12</td>
<td>20.0</td>
<td>53.98</td>
<td>100.0</td>
<td>52.06</td>
<td>30.0</td>
<td>54.00</td>
<td>114.0</td>
<td>52.0</td>
<td>1702.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:30:00.082945826</td>
<td>34200.082946</td>
<td>1</td>
<td>5947466</td>
<td>30</td>
<td>53.05</td>
<td>-1</td>
<td>53.05</td>
<td>30.0</td>
<td>53.0</td>
<td>202.0</td>
<td>...</td>
<td>52.12</td>
<td>20.0</td>
<td>53.97</td>
<td>200.0</td>
<td>52.06</td>
<td>30.0</td>
<td>53.98</td>
<td>100.0</td>
<td>52.0</td>
<td>1702.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:30:00.082945826</td>
<td>34200.082946</td>
<td>1</td>
<td>6468306</td>
<td>4</td>
<td>53.00</td>
<td>1</td>
<td>53.05</td>
<td>30.0</td>
<td>53.0</td>
<td>206.0</td>
<td>...</td>
<td>52.12</td>
<td>20.0</td>
<td>53.97</td>
<td>200.0</td>
<td>52.06</td>
<td>30.0</td>
<td>53.98</td>
<td>100.0</td>
<td>52.0</td>
<td>1702.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:30:00.082945826</td>
<td>34200.082946</td>
<td>1</td>
<td>9140546</td>
<td>15</td>
<td>53.35</td>
<td>-1</td>
<td>53.05</td>
<td>30.0</td>
<td>53.0</td>
<td>206.0</td>
<td>...</td>
<td>52.12</td>
<td>20.0</td>
<td>53.95</td>
<td>100.0</td>
<td>52.06</td>
<td>30.0</td>
<td>53.97</td>
<td>200.0</td>
<td>52.0</td>
<td>1702.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 46 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df.query(f"event == {Event.CANCELLATION.value}")</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df.query(<span class="ss">f"event in </span><span class="sc">{</span>EventGroup<span class="sc">.</span>CANCELLATIONS<span class="sc">.</span>value<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th">order_id</th>
<th data-quarto-table-cell-role="th">size</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">direction</th>
<th data-quarto-table-cell-role="th">ask_price_1</th>
<th data-quarto-table-cell-role="th">ask_size_1</th>
<th data-quarto-table-cell-role="th">bid_price_1</th>
<th data-quarto-table-cell-role="th">bid_size_1</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">bid_price_8</th>
<th data-quarto-table-cell-role="th">bid_size_8</th>
<th data-quarto-table-cell-role="th">ask_price_9</th>
<th data-quarto-table-cell-role="th">ask_size_9</th>
<th data-quarto-table-cell-role="th">bid_price_9</th>
<th data-quarto-table-cell-role="th">bid_size_9</th>
<th data-quarto-table-cell-role="th">ask_price_10</th>
<th data-quarto-table-cell-role="th">ask_size_10</th>
<th data-quarto-table-cell-role="th">bid_price_10</th>
<th data-quarto-table-cell-role="th">bid_size_10</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:30:00.110179536</td>
<td>34200.110180</td>
<td>3</td>
<td>17448442</td>
<td>100</td>
<td>53.06</td>
<td>1</td>
<td>53.31</td>
<td>100.0</td>
<td>53.06</td>
<td>100.0</td>
<td>...</td>
<td>52.50</td>
<td>101.0</td>
<td>53.87</td>
<td>1.0</td>
<td>52.48</td>
<td>2.0</td>
<td>53.89</td>
<td>4.0</td>
<td>52.46</td>
<td>150.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:30:00.114103147</td>
<td>34200.114103</td>
<td>3</td>
<td>17446506</td>
<td>100</td>
<td>53.32</td>
<td>-1</td>
<td>53.31</td>
<td>100.0</td>
<td>53.06</td>
<td>100.0</td>
<td>...</td>
<td>52.50</td>
<td>101.0</td>
<td>53.89</td>
<td>4.0</td>
<td>52.48</td>
<td>2.0</td>
<td>53.90</td>
<td>25.0</td>
<td>52.46</td>
<td>150.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:30:00.119725654</td>
<td>34200.119726</td>
<td>3</td>
<td>17448438</td>
<td>100</td>
<td>53.06</td>
<td>1</td>
<td>53.31</td>
<td>100.0</td>
<td>53.00</td>
<td>1921.0</td>
<td>...</td>
<td>52.48</td>
<td>2.0</td>
<td>53.89</td>
<td>4.0</td>
<td>52.46</td>
<td>150.0</td>
<td>53.90</td>
<td>25.0</td>
<td>52.20</td>
<td>30.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:30:00.284641278</td>
<td>34200.284641</td>
<td>3</td>
<td>17518474</td>
<td>100</td>
<td>53.31</td>
<td>-1</td>
<td>53.31</td>
<td>100.0</td>
<td>53.00</td>
<td>1941.0</td>
<td>...</td>
<td>52.48</td>
<td>2.0</td>
<td>53.77</td>
<td>56.0</td>
<td>52.46</td>
<td>150.0</td>
<td>53.78</td>
<td>500.0</td>
<td>52.20</td>
<td>30.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:30:00.312664446</td>
<td>34200.312664</td>
<td>3</td>
<td>9101262</td>
<td>85</td>
<td>53.00</td>
<td>1</td>
<td>53.31</td>
<td>100.0</td>
<td>53.08</td>
<td>150.0</td>
<td>...</td>
<td>52.50</td>
<td>101.0</td>
<td>53.77</td>
<td>56.0</td>
<td>52.48</td>
<td>2.0</td>
<td>53.78</td>
<td>500.0</td>
<td>52.46</td>
<td>150.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.406510378</td>
<td>57599.406510</td>
<td>3</td>
<td>515511430</td>
<td>1000</td>
<td>51.76</td>
<td>1</td>
<td>51.86</td>
<td>100.0</td>
<td>51.83</td>
<td>100.0</td>
<td>...</td>
<td>51.75</td>
<td>100.0</td>
<td>51.94</td>
<td>300.0</td>
<td>51.74</td>
<td>102.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.73</td>
<td>700.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.432250448</td>
<td>57599.432250</td>
<td>3</td>
<td>514786138</td>
<td>1000</td>
<td>51.90</td>
<td>-1</td>
<td>51.87</td>
<td>6440.0</td>
<td>51.83</td>
<td>100.0</td>
<td>...</td>
<td>51.75</td>
<td>100.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.74</td>
<td>102.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.73</td>
<td>700.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.432522769</td>
<td>57599.432523</td>
<td>3</td>
<td>514678078</td>
<td>630</td>
<td>51.91</td>
<td>-1</td>
<td>51.87</td>
<td>6440.0</td>
<td>51.83</td>
<td>100.0</td>
<td>...</td>
<td>51.75</td>
<td>100.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.74</td>
<td>102.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.73</td>
<td>700.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.530882222</td>
<td>57599.530882</td>
<td>3</td>
<td>515645938</td>
<td>100</td>
<td>51.83</td>
<td>1</td>
<td>51.87</td>
<td>14240.0</td>
<td>51.81</td>
<td>305.0</td>
<td>...</td>
<td>51.74</td>
<td>102.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.73</td>
<td>700.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.72</td>
<td>200.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.687988391</td>
<td>57599.687988</td>
<td>3</td>
<td>515597118</td>
<td>100</td>
<td>51.79</td>
<td>1</td>
<td>51.87</td>
<td>15640.0</td>
<td>51.86</td>
<td>143.0</td>
<td>...</td>
<td>51.74</td>
<td>102.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.73</td>
<td>700.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.72</td>
<td>200.0</td>
</tr>
</tbody>
</table>

<p>363788 rows × 46 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df[df.index <span class="op">&lt;=</span> dt.datetime(<span class="dv">2021</span>, <span class="dv">1</span>, <span class="dv">5</span>)].ask_size_1.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='datetime'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-8-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df[df.ask_size_1 <span class="op">&gt;=</span> <span class="dv">40_000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">event</th>
<th data-quarto-table-cell-role="th">order_id</th>
<th data-quarto-table-cell-role="th">size</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">direction</th>
<th data-quarto-table-cell-role="th">ask_price_1</th>
<th data-quarto-table-cell-role="th">ask_size_1</th>
<th data-quarto-table-cell-role="th">bid_price_1</th>
<th data-quarto-table-cell-role="th">bid_size_1</th>
<th data-quarto-table-cell-role="th">ask_price_2</th>
<th data-quarto-table-cell-role="th">ask_size_2</th>
<th data-quarto-table-cell-role="th">bid_price_2</th>
<th data-quarto-table-cell-role="th">bid_size_2</th>
<th data-quarto-table-cell-role="th">ask_price_3</th>
<th data-quarto-table-cell-role="th">ask_size_3</th>
<th data-quarto-table-cell-role="th">bid_price_3</th>
<th data-quarto-table-cell-role="th">bid_size_3</th>
<th data-quarto-table-cell-role="th">ask_price_4</th>
<th data-quarto-table-cell-role="th">ask_size_4</th>
<th data-quarto-table-cell-role="th">bid_price_4</th>
<th data-quarto-table-cell-role="th">bid_size_4</th>
<th data-quarto-table-cell-role="th">ask_price_5</th>
<th data-quarto-table-cell-role="th">ask_size_5</th>
<th data-quarto-table-cell-role="th">bid_price_5</th>
<th data-quarto-table-cell-role="th">bid_size_5</th>
<th data-quarto-table-cell-role="th">ask_price_6</th>
<th data-quarto-table-cell-role="th">ask_size_6</th>
<th data-quarto-table-cell-role="th">bid_price_6</th>
<th data-quarto-table-cell-role="th">bid_size_6</th>
<th data-quarto-table-cell-role="th">ask_price_7</th>
<th data-quarto-table-cell-role="th">ask_size_7</th>
<th data-quarto-table-cell-role="th">bid_price_7</th>
<th data-quarto-table-cell-role="th">bid_size_7</th>
<th data-quarto-table-cell-role="th">ask_price_8</th>
<th data-quarto-table-cell-role="th">ask_size_8</th>
<th data-quarto-table-cell-role="th">bid_price_8</th>
<th data-quarto-table-cell-role="th">bid_size_8</th>
<th data-quarto-table-cell-role="th">ask_price_9</th>
<th data-quarto-table-cell-role="th">ask_size_9</th>
<th data-quarto-table-cell-role="th">bid_price_9</th>
<th data-quarto-table-cell-role="th">bid_size_9</th>
<th data-quarto-table-cell-role="th">ask_price_10</th>
<th data-quarto-table-cell-role="th">ask_size_10</th>
<th data-quarto-table-cell-role="th">bid_price_10</th>
<th data-quarto-table-cell-role="th">bid_size_10</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>7315742</td>
<td>100</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40059.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>8345038</td>
<td>100</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40159.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>8490406</td>
<td>50</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40209.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>8490410</td>
<td>101</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40310.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>8490414</td>
<td>80</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40390.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>9856982</td>
<td>50</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40440.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>10166442</td>
<td>20</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40460.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>10199754</td>
<td>12</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40472.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>12712170</td>
<td>4</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40476.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>12807926</td>
<td>1</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40477.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>15496002</td>
<td>20</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40497.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>16607122</td>
<td>55</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>100.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>8292458</td>
<td>1</td>
<td>52.01</td>
<td>-1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.50</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>10176730</td>
<td>3</td>
<td>52.02</td>
<td>-1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.10</td>
<td>13.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>5157994</td>
<td>3</td>
<td>52.10</td>
<td>-1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.40</td>
<td>1000.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>7321898</td>
<td>50</td>
<td>52.13</td>
<td>-1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.35</td>
<td>200.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284914908</td>
<td>34202.284915</td>
<td>1</td>
<td>9856986</td>
<td>50</td>
<td>52.19</td>
<td>-1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.284993899</td>
<td>34202.284994</td>
<td>1</td>
<td>20328842</td>
<td>100</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40652.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.285017572</td>
<td>34202.285018</td>
<td>3</td>
<td>20328842</td>
<td>100</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.356629832</td>
<td>34202.356630</td>
<td>5</td>
<td>0</td>
<td>50</td>
<td>51.93</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.92</td>
<td>2.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.356629832</td>
<td>34202.356630</td>
<td>4</td>
<td>20270410</td>
<td>1</td>
<td>51.92</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.92</td>
<td>1.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.356629832</td>
<td>34202.356630</td>
<td>4</td>
<td>20320738</td>
<td>1</td>
<td>51.92</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.90</td>
<td>600.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.368268744</td>
<td>34202.368269</td>
<td>3</td>
<td>20339402</td>
<td>100</td>
<td>51.96</td>
<td>-1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.387749812</td>
<td>34202.387750</td>
<td>5</td>
<td>0</td>
<td>100</td>
<td>51.90</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.387749812</td>
<td>34202.387750</td>
<td>5</td>
<td>0</td>
<td>100</td>
<td>51.91</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.387749812</td>
<td>34202.387750</td>
<td>5</td>
<td>0</td>
<td>50</td>
<td>51.91</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.387749812</td>
<td>34202.387750</td>
<td>5</td>
<td>0</td>
<td>100</td>
<td>51.92</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.387749812</td>
<td>34202.387750</td>
<td>5</td>
<td>0</td>
<td>100</td>
<td>51.94</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.387749812</td>
<td>34202.387750</td>
<td>5</td>
<td>0</td>
<td>100</td>
<td>51.96</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.387749812</td>
<td>34202.387750</td>
<td>5</td>
<td>0</td>
<td>100</td>
<td>51.97</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.387749812</td>
<td>34202.387750</td>
<td>5</td>
<td>0</td>
<td>50</td>
<td>51.97</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>30.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.476847786</td>
<td>34202.476848</td>
<td>1</td>
<td>20355358</td>
<td>200</td>
<td>51.32</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.476849390</td>
<td>34202.476849</td>
<td>1</td>
<td>20355362</td>
<td>200</td>
<td>52.27</td>
<td>-1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.26</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.490087932</td>
<td>34202.490088</td>
<td>3</td>
<td>20315190</td>
<td>100</td>
<td>52.26</td>
<td>-1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.26</td>
<td>1005.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.25</td>
<td>75.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.629170962</td>
<td>34202.629171</td>
<td>1</td>
<td>20375298</td>
<td>300</td>
<td>51.68</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.68</td>
<td>300.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.665693889</td>
<td>34202.665694</td>
<td>1</td>
<td>20379158</td>
<td>300</td>
<td>51.68</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.68</td>
<td>600.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.30</td>
<td>10.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.26</td>
<td>1005.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.721729544</td>
<td>34202.721730</td>
<td>1</td>
<td>20386758</td>
<td>300</td>
<td>51.82</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.82</td>
<td>300.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.68</td>
<td>600.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.728007933</td>
<td>34202.728008</td>
<td>5</td>
<td>0</td>
<td>100</td>
<td>51.88</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.82</td>
<td>300.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.68</td>
<td>600.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.728007933</td>
<td>34202.728008</td>
<td>5</td>
<td>0</td>
<td>100</td>
<td>51.86</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.82</td>
<td>300.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.68</td>
<td>600.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:02.728007933</td>
<td>34202.728008</td>
<td>5</td>
<td>0</td>
<td>100</td>
<td>51.86</td>
<td>1</td>
<td>52.00</td>
<td>40552.0</td>
<td>51.82</td>
<td>300.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.81</td>
<td>90.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.68</td>
<td>600.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.66</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:03.504531423</td>
<td>34203.504531</td>
<td>4</td>
<td>20387778</td>
<td>5</td>
<td>51.97</td>
<td>-1</td>
<td>52.00</td>
<td>40832.0</td>
<td>51.92</td>
<td>62.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.86</td>
<td>300.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.84</td>
<td>200.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.77</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.67</td>
<td>100.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.32</td>
<td>230.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:03.504531423</td>
<td>34203.504531</td>
<td>5</td>
<td>0</td>
<td>95</td>
<td>51.98</td>
<td>1</td>
<td>52.00</td>
<td>40832.0</td>
<td>51.92</td>
<td>62.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.86</td>
<td>300.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.84</td>
<td>200.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.77</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.67</td>
<td>100.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.32</td>
<td>230.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:03.504560333</td>
<td>34203.504560</td>
<td>1</td>
<td>20518682</td>
<td>100</td>
<td>51.94</td>
<td>1</td>
<td>52.00</td>
<td>40832.0</td>
<td>51.94</td>
<td>100.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.92</td>
<td>62.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.86</td>
<td>300.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.84</td>
<td>200.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.77</td>
<td>100.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.67</td>
<td>100.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.33</td>
<td>500.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:03.504817539</td>
<td>34203.504818</td>
<td>3</td>
<td>20516054</td>
<td>100</td>
<td>51.84</td>
<td>1</td>
<td>52.00</td>
<td>40832.0</td>
<td>51.94</td>
<td>100.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.92</td>
<td>62.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.86</td>
<td>300.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.84</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.77</td>
<td>100.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.67</td>
<td>100.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.33</td>
<td>500.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:03.505022047</td>
<td>34203.505022</td>
<td>3</td>
<td>20517802</td>
<td>300</td>
<td>51.86</td>
<td>1</td>
<td>52.00</td>
<td>40832.0</td>
<td>51.94</td>
<td>100.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.92</td>
<td>62.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.84</td>
<td>100.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.77</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.67</td>
<td>100.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.32</td>
<td>230.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:03.510243624</td>
<td>34203.510244</td>
<td>5</td>
<td>0</td>
<td>100</td>
<td>51.99</td>
<td>1</td>
<td>52.00</td>
<td>40832.0</td>
<td>51.94</td>
<td>100.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.92</td>
<td>62.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.84</td>
<td>100.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.77</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.67</td>
<td>100.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.32</td>
<td>230.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:03.510243624</td>
<td>34203.510244</td>
<td>4</td>
<td>4301782</td>
<td>40</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40792.0</td>
<td>51.94</td>
<td>100.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.92</td>
<td>62.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.84</td>
<td>100.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.77</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.67</td>
<td>100.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.32</td>
<td>230.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:03.510244610</td>
<td>34203.510245</td>
<td>3</td>
<td>20516454</td>
<td>62</td>
<td>51.92</td>
<td>1</td>
<td>52.00</td>
<td>40792.0</td>
<td>51.94</td>
<td>100.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.84</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.77</td>
<td>100.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.67</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-05 09:30:03.510505738</td>
<td>34203.510506</td>
<td>4</td>
<td>4301782</td>
<td>200</td>
<td>52.00</td>
<td>-1</td>
<td>52.00</td>
<td>40592.0</td>
<td>51.94</td>
<td>100.0</td>
<td>52.01</td>
<td>101.0</td>
<td>51.84</td>
<td>100.0</td>
<td>52.02</td>
<td>3.0</td>
<td>51.77</td>
<td>100.0</td>
<td>52.10</td>
<td>16.0</td>
<td>51.67</td>
<td>100.0</td>
<td>52.13</td>
<td>50.0</td>
<td>51.50</td>
<td>523.0</td>
<td>52.16</td>
<td>5.0</td>
<td>51.44</td>
<td>2000.0</td>
<td>52.19</td>
<td>50.0</td>
<td>51.39</td>
<td>200.0</td>
<td>52.20</td>
<td>1017.0</td>
<td>51.33</td>
<td>500.0</td>
<td>52.27</td>
<td>200.0</td>
<td>51.32</td>
<td>230.0</td>
<td>52.30</td>
<td>100.0</td>
<td>51.30</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.823431014</td>
<td>57599.823431</td>
<td>1</td>
<td>515892526</td>
<td>6100</td>
<td>51.87</td>
<td>-1</td>
<td>51.87</td>
<td>41640.0</td>
<td>51.86</td>
<td>190.0</td>
<td>51.88</td>
<td>8867.0</td>
<td>51.81</td>
<td>305.0</td>
<td>51.89</td>
<td>5930.0</td>
<td>51.80</td>
<td>601.0</td>
<td>51.90</td>
<td>3500.0</td>
<td>51.78</td>
<td>310.0</td>
<td>51.91</td>
<td>2362.0</td>
<td>51.77</td>
<td>1700.0</td>
<td>51.92</td>
<td>200.0</td>
<td>51.76</td>
<td>1700.0</td>
<td>51.93</td>
<td>2400.0</td>
<td>51.75</td>
<td>100.0</td>
<td>51.94</td>
<td>500.0</td>
<td>51.74</td>
<td>102.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.73</td>
<td>700.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.72</td>
<td>200.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.823446081</td>
<td>57599.823446</td>
<td>1</td>
<td>515892530</td>
<td>6100</td>
<td>51.87</td>
<td>-1</td>
<td>51.87</td>
<td>47740.0</td>
<td>51.86</td>
<td>190.0</td>
<td>51.88</td>
<td>8867.0</td>
<td>51.81</td>
<td>305.0</td>
<td>51.89</td>
<td>5930.0</td>
<td>51.80</td>
<td>601.0</td>
<td>51.90</td>
<td>3500.0</td>
<td>51.78</td>
<td>310.0</td>
<td>51.91</td>
<td>2362.0</td>
<td>51.77</td>
<td>1700.0</td>
<td>51.92</td>
<td>200.0</td>
<td>51.76</td>
<td>1700.0</td>
<td>51.93</td>
<td>2400.0</td>
<td>51.75</td>
<td>100.0</td>
<td>51.94</td>
<td>500.0</td>
<td>51.74</td>
<td>102.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.73</td>
<td>700.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.72</td>
<td>200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.905487894</td>
<td>57599.905488</td>
<td>4</td>
<td>515224062</td>
<td>500</td>
<td>51.87</td>
<td>-1</td>
<td>51.87</td>
<td>47240.0</td>
<td>51.86</td>
<td>190.0</td>
<td>51.88</td>
<td>8867.0</td>
<td>51.81</td>
<td>305.0</td>
<td>51.89</td>
<td>5930.0</td>
<td>51.80</td>
<td>601.0</td>
<td>51.90</td>
<td>3500.0</td>
<td>51.78</td>
<td>310.0</td>
<td>51.91</td>
<td>2362.0</td>
<td>51.77</td>
<td>1700.0</td>
<td>51.92</td>
<td>200.0</td>
<td>51.76</td>
<td>1700.0</td>
<td>51.93</td>
<td>2400.0</td>
<td>51.75</td>
<td>100.0</td>
<td>51.94</td>
<td>500.0</td>
<td>51.74</td>
<td>102.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.73</td>
<td>700.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.72</td>
<td>200.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.905487894</td>
<td>57599.905488</td>
<td>4</td>
<td>515235650</td>
<td>100</td>
<td>51.87</td>
<td>-1</td>
<td>51.87</td>
<td>47140.0</td>
<td>51.86</td>
<td>190.0</td>
<td>51.88</td>
<td>8867.0</td>
<td>51.81</td>
<td>305.0</td>
<td>51.89</td>
<td>5930.0</td>
<td>51.80</td>
<td>601.0</td>
<td>51.90</td>
<td>3500.0</td>
<td>51.78</td>
<td>310.0</td>
<td>51.91</td>
<td>2362.0</td>
<td>51.77</td>
<td>1700.0</td>
<td>51.92</td>
<td>200.0</td>
<td>51.76</td>
<td>1700.0</td>
<td>51.93</td>
<td>2400.0</td>
<td>51.75</td>
<td>100.0</td>
<td>51.94</td>
<td>500.0</td>
<td>51.74</td>
<td>102.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.73</td>
<td>700.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.72</td>
<td>200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.905487894</td>
<td>57599.905488</td>
<td>4</td>
<td>515269246</td>
<td>100</td>
<td>51.87</td>
<td>-1</td>
<td>51.87</td>
<td>47040.0</td>
<td>51.86</td>
<td>190.0</td>
<td>51.88</td>
<td>8867.0</td>
<td>51.81</td>
<td>305.0</td>
<td>51.89</td>
<td>5930.0</td>
<td>51.80</td>
<td>601.0</td>
<td>51.90</td>
<td>3500.0</td>
<td>51.78</td>
<td>310.0</td>
<td>51.91</td>
<td>2362.0</td>
<td>51.77</td>
<td>1700.0</td>
<td>51.92</td>
<td>200.0</td>
<td>51.76</td>
<td>1700.0</td>
<td>51.93</td>
<td>2400.0</td>
<td>51.75</td>
<td>100.0</td>
<td>51.94</td>
<td>500.0</td>
<td>51.74</td>
<td>102.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.73</td>
<td>700.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.72</td>
<td>200.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.905531803</td>
<td>57599.905532</td>
<td>1</td>
<td>515899486</td>
<td>100</td>
<td>51.87</td>
<td>-1</td>
<td>51.87</td>
<td>47140.0</td>
<td>51.86</td>
<td>190.0</td>
<td>51.88</td>
<td>8867.0</td>
<td>51.81</td>
<td>305.0</td>
<td>51.89</td>
<td>5930.0</td>
<td>51.80</td>
<td>601.0</td>
<td>51.90</td>
<td>3500.0</td>
<td>51.78</td>
<td>310.0</td>
<td>51.91</td>
<td>2362.0</td>
<td>51.77</td>
<td>1700.0</td>
<td>51.92</td>
<td>200.0</td>
<td>51.76</td>
<td>1700.0</td>
<td>51.93</td>
<td>2400.0</td>
<td>51.75</td>
<td>100.0</td>
<td>51.94</td>
<td>500.0</td>
<td>51.74</td>
<td>102.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.73</td>
<td>700.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.72</td>
<td>200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-07 15:59:59.911895773</td>
<td>57599.911896</td>
<td>4</td>
<td>515882266</td>
<td>17</td>
<td>51.86</td>
<td>1</td>
<td>51.87</td>
<td>47140.0</td>
<td>51.86</td>
<td>173.0</td>
<td>51.88</td>
<td>8867.0</td>
<td>51.81</td>
<td>305.0</td>
<td>51.89</td>
<td>5930.0</td>
<td>51.80</td>
<td>601.0</td>
<td>51.90</td>
<td>3500.0</td>
<td>51.78</td>
<td>310.0</td>
<td>51.91</td>
<td>2362.0</td>
<td>51.77</td>
<td>1700.0</td>
<td>51.92</td>
<td>200.0</td>
<td>51.76</td>
<td>1700.0</td>
<td>51.93</td>
<td>2400.0</td>
<td>51.75</td>
<td>100.0</td>
<td>51.94</td>
<td>500.0</td>
<td>51.74</td>
<td>102.0</td>
<td>51.96</td>
<td>600.0</td>
<td>51.73</td>
<td>700.0</td>
<td>51.97</td>
<td>2000.0</td>
<td>51.72</td>
<td>200.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>all_symbols <span class="op">=</span> arctic[<span class="st">"2021"</span>].list_symbols()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>equities <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(equities).intersection(all_symbols))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_trading_days(df):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df.groupby(df.index.date).first().index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_single_ticker_executions(ticker, date_range<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Read executions from database for single ticker."""</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    columns <span class="op">=</span> [</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"time"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"event"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"order_id"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"size"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"price"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"direction"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ask_price_1"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"bid_price_1"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    q <span class="op">=</span> QueryBuilder()</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># q = q[q.event.isin(EventGroup.EXECUTIONS.value)]</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> arctic_library.read(</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        symbol<span class="op">=</span>ticker, query_builder<span class="op">=</span>q, columns<span class="op">=</span>columns, date_range<span class="op">=</span>date_range</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    ).data</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.assign(</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        ticker<span class="op">=</span>ticker, mid<span class="op">=</span><span class="kw">lambda</span> _df: (_df[<span class="st">"bid_price_1"</span>] <span class="op">+</span> _df[<span class="st">"ask_price_1"</span>]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    ).astype({<span class="st">"ticker"</span>: <span class="st">"category"</span>})</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_multiple_tickers_executions(tickers, date_range<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Multiple version of `read_single_ticker_executions`."""</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        pd.concat(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>            read_single_ticker_executions(ticker, date_range) <span class="cf">for</span> ticker <span class="kw">in</span> tickers</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        .sort_index()</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        .astype({<span class="st">"ticker"</span>: <span class="st">"category"</span>})</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> date_to_tuple(date: dt.date):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    end_of_trading <span class="op">=</span> dt.time(hour<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (date, dt.datetime.combine(date, end_of_trading))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_datetime_tuples(start_date, end_date):</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    dates <span class="op">=</span> pd.date_range(start<span class="op">=</span>start_date, end<span class="op">=</span>end_date, freq<span class="op">=</span><span class="st">"D"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    dates <span class="op">=</span> [x.date() <span class="cf">for</span> x <span class="kw">in</span> dates]</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    date_tuples <span class="op">=</span> [date_to_tuple(x) <span class="cf">for</span> x <span class="kw">in</span> dates]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> date_tuples</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> timestamp_to_tuple(timestamp):</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    end_of_trading_day <span class="op">=</span> pd.Timedelta(hours<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># could also return datetimes with .to_pydatetime</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (timestamp, timestamp <span class="op">+</span> end_of_trading_day)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_timestamp_tuples(start_date, end_date):</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    dates <span class="op">=</span> pd.date_range(start<span class="op">=</span>start_date, end<span class="op">=</span>end_date, freq<span class="op">=</span><span class="st">"D"</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    date_tuples <span class="op">=</span> [timestamp_to_tuple(x) <span class="cf">for</span> x <span class="kw">in</span> dates]</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> date_tuples</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One day</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_mids_for_etf(ticker, date_range):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get only mids at a specified resample frequency."""</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    columns <span class="op">=</span> [</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ask_price_1"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"bid_price_1"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    q <span class="op">=</span> QueryBuilder()</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> arctic_library.read(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        symbol<span class="op">=</span>ticker, query_builder<span class="op">=</span>q, columns<span class="op">=</span>columns, date_range<span class="op">=</span>date_range</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    ).data</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.assign(</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        ticker<span class="op">=</span>ticker, mid<span class="op">=</span><span class="kw">lambda</span> _df: (_df[<span class="st">"bid_price_1"</span>] <span class="op">+</span> _df[<span class="st">"ask_price_1"</span>]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    ).astype({<span class="st">"ticker"</span>: <span class="st">"category"</span>})</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    resampled_mid <span class="op">=</span> df.mid.resample(<span class="st">"30S"</span>, label<span class="op">=</span><span class="st">"right"</span>, closed<span class="op">=</span><span class="st">"left"</span>).last()</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df, resampled_mid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> markout_to_int(markout: <span class="bu">str</span>, finest_resample: <span class="bu">str</span> <span class="op">=</span> <span class="st">"30S"</span>):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Maybe add stuff where checks this is almost an int"""</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    ratio <span class="op">=</span> pd.Timedelta(markout) <span class="op">/</span> pd.Timedelta(finest_resample)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> np.isclose(ratio, np.<span class="bu">round</span>(ratio), atol<span class="op">=</span><span class="fl">1e-4</span>):</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(np.<span class="bu">round</span>(ratio))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="pp">ValueError</span>(<span class="st">"Markouts must be multiples of finest resample frequency"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>markout_to_int(<span class="st">"1min"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_log_returns(mid):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute mid price dataframe at various markouts and compute log returns for those markouts"""</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(mid)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    markouts_str <span class="op">=</span> [<span class="st">"30S"</span>, <span class="st">"1min"</span>, <span class="st">"2min"</span>]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    Markout <span class="op">=</span> namedtuple(<span class="st">"Markout"</span>, [<span class="st">"str"</span>, <span class="st">"int"</span>])</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    markouts <span class="op">=</span> [Markout(x, markout_to_int(x)) <span class="cf">for</span> x <span class="kw">in</span> markouts_str]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> markout <span class="kw">in</span> markouts:</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        df[<span class="ss">f"_</span><span class="sc">{</span>markout<span class="sc">.</span><span class="bu">str</span><span class="sc">}</span><span class="ss">"</span>] <span class="op">=</span> df.mid.shift(<span class="op">-</span>markout.<span class="bu">int</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.resample(<span class="st">"5min"</span>, label<span class="op">=</span><span class="st">"right"</span>, closed<span class="op">=</span><span class="st">"right"</span>).last()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># not sure how to drop all resampled buckets where there was a NaN before</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for now simply drop last row of resampled dataframe</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.iloc[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># now compute log returns</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># markout_columns = df.filter(regex="^_").columns.to_list()</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    markout_columns <span class="op">=</span> [<span class="ss">f"_</span><span class="sc">{</span>markout<span class="sc">.</span><span class="bu">str</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> markout <span class="kw">in</span> markouts]</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    log_returns <span class="op">=</span> np.log(df[markout_columns].divide(df.mid, axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># is it better to take differences? this feels like it should be better but doesn't run</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print('hi')</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># breakpoint()</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># log_returns = np.log(df[markout_columns]) - np.log(df.mid)</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># markout_to_int(resample_freq)</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    contemp_log_returns <span class="op">=</span> np.log(df.mid) <span class="op">-</span> np.log(df.mid.shift(<span class="dv">1</span>))</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    log_returns[<span class="st">"contemp"</span>] <span class="op">=</span> contemp_log_returns</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: better way to do this?</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># resampling goes through non trading periods</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    log_returns.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> log_returns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_ofi(df):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Compute ofi. Times are right stamped in that you know the ofi at that time.</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Closed is left here as it is unlikely to have a stamp exactly on the dot.</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    ofi <span class="op">=</span> (</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        df[[<span class="st">"size"</span>, <span class="st">"direction"</span>]]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">eval</span>(<span class="st">"signed_size = size * direction"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        .drop(columns<span class="op">=</span>[<span class="st">"direction"</span>])</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>        .resample(resample_freq, label<span class="op">=</span><span class="st">"right"</span>, closed<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">sum</span>()</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        .between_time(<span class="st">"09:29"</span>, <span class="st">"16:01"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        .<span class="bu">eval</span>(<span class="st">"ofi = signed_size / size"</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        .ofi.fillna(<span class="dv">0</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ofi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_regressions(X, Y):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> MultiOutputRegressor(LinearRegression(fit_intercept<span class="op">=</span><span class="va">False</span>)).fit(X, Y)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col, estimator <span class="kw">in</span> <span class="bu">zip</span>(Y.columns, model.estimators_):</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        results.append(</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"target_markout"</span>: col,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"r2"</span>: estimator.score(X, Y[col]),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"coef"</span>: estimator.coef_,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"intercept"</span>: estimator.intercept_,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    results_df <span class="op">=</span> pd.DataFrame(results).set_index(<span class="st">"target_markout"</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_neighbor_statistics(etf_executions_neighbors: pd.DataFrame):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    neighbor_statistics <span class="op">=</span> etf_executions_neighbors.<span class="bu">filter</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        regex<span class="op">=</span><span class="st">"^_"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    ).notna().<span class="bu">sum</span>() <span class="op">/</span> <span class="bu">len</span>(etf_executions_neighbors)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbor_statistics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['time', 'event', 'order_id', 'size', 'price', 'direction',
       'ask_price_1', 'bid_price_1', 'ticker', 'mid', '_250us_neighbors',
       '_500us_neighbors', '_250us_distinct_tickers_ss_bf',
       '_250us_distinct_tickers_ss_af', '_250us_distinct_tickers_os_bf',
       '_250us_distinct_tickers_os_af', '_250us_notional_ss_bf',
       '_250us_notional_ss_af', '_250us_notional_os_bf',
       '_250us_notional_os_af', '_250us_num_trades_ss_bf',
       '_250us_num_trades_ss_af', '_250us_num_trades_os_bf',
       '_250us_num_trades_os_af', '_500us_distinct_tickers_ss_bf',
       '_500us_distinct_tickers_ss_af', '_500us_distinct_tickers_os_bf',
       '_500us_distinct_tickers_os_af', '_500us_notional_ss_bf',
       '_500us_notional_ss_af', '_500us_notional_os_bf',
       '_500us_notional_os_af', '_500us_num_trades_ss_bf',
       '_500us_num_trades_ss_af', '_500us_num_trades_os_bf',
       '_500us_num_trades_os_af', 'pnl_to_close', 'hit_ratio'],
      dtype='object')</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/n-petit/lobster-tools/blob/main/lobster_tools/etf_pipeline_s3.py#L29" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="quick_marginalize" class="level3">
<h3 class="anchored" data-anchor-id="quick_marginalize">quick_marginalize</h3>
<blockquote class="blockquote">
<pre><code> quick_marginalize (df:pandas.core.frame.DataFrame)</code></pre>
</blockquote>
<p>Manual implementation but for all features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sparse_to_dense(df):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Convert all sparse columns to dense."""</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    sparse_columns <span class="op">=</span> [</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        col <span class="cf">for</span> col <span class="kw">in</span> df.columns <span class="cf">if</span> <span class="bu">isinstance</span>(df[col].dtype, pd.SparseDtype)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    df[sparse_columns] <span class="op">=</span> df[sparse_columns].sparse.to_dense()</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> keep_bins(s: pd.Series):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    value_counts <span class="op">=</span> s.value_counts().sort_index()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    CUTOFF <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    not_enough_data <span class="op">=</span> value_counts <span class="op">&lt;</span> CUTOFF</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    up_to <span class="op">=</span> not_enough_data.idxmax()</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> up_to</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pnl_columns(df):</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.copy(deep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    CLOSE_PRICE <span class="op">=</span> (</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>        df.query(<span class="st">"direction == 1"</span>).iloc[<span class="op">-</span><span class="dv">1</span>].price</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> df.query(<span class="st">"direction == -1"</span>).iloc[<span class="op">-</span><span class="dv">1</span>].price</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.assign(</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>        pnl_to_close_bps<span class="op">=</span><span class="kw">lambda</span> df_: (CLOSE_PRICE <span class="op">-</span> df_.price)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">/</span> df_.price</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span> <span class="fl">1e4</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span> df_.direction,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        hit_ratio<span class="op">=</span><span class="kw">lambda</span> df_: ((df_.pnl_to_close_bps) <span class="op">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="poolprocess-for-many-dates" class="level2">
<h2 class="anchored" data-anchor-id="poolprocess-for-many-dates">PoolProcess for many dates</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dump_to_pickle(date):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"This is not useful..right?"</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(etfs)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(equities)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    equity_executions <span class="op">=</span> read_multiple_tickers_executions(</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        tickers<span class="op">=</span>equities, date_range<span class="op">=</span>date</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    etf_executions <span class="op">=</span> read_multiple_tickers_executions(tickers<span class="op">=</span>etfs, date_range<span class="op">=</span>date)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    etf_executions_neighbors <span class="op">=</span> add_neighbors(</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        etf_executions<span class="op">=</span>etf_executions,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        equity_executions<span class="op">=</span>equity_executions,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        tolerances<span class="op">=</span>tolerances,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    etf_executions_features <span class="op">=</span> append_features(</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        etf_executions<span class="op">=</span>etf_executions_neighbors, equity_executions<span class="op">=</span>equity_executions</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    etf_executions_features_pnl <span class="op">=</span> add_pnl_columns(etf_executions_features)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for now just one etf</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if want to pickle</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># assert len(etfs) == 1</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># etf_name = etfs[0]</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    date_str <span class="op">=</span> dt.datetime.combine(date[<span class="dv">0</span>], dt.datetime.<span class="bu">min</span>.time()).strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># etf_executions_features_pnl.to_pickle(f"../features/{etf_name}_{date_str}")</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"done </span><span class="sc">{</span>date_str<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> etf_executions_features_pnl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> filter_to_existing_equities(equities):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    existing_symbols <span class="op">=</span> arctic_library.list_symbols()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">set</span>(equities).intersection(<span class="bu">set</span>(existing_symbols)))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>equities <span class="op">=</span> filter_to_existing_equities(equities)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(equities)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> concurrent.futures <span class="im">import</span> ProcessPoolExecutor, as_completed, wait</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> NASDAQExchange().trading_days</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> dates</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> [date_to_tuple(x) <span class="cf">for</span> x <span class="kw">in</span> dates]</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> dates[:<span class="dv">70</span>]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> ProcessPoolExecutor(max_workers<span class="op">=</span><span class="dv">70</span>) <span class="im">as</span> executor:</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    dfs <span class="op">=</span> <span class="bu">list</span>(executor.<span class="bu">map</span>(dump_to_pickle, dates))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat(dfs)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>df.to_pickle(<span class="st">"../features/SPY_all_10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df.to_pickle(<span class="st">"../features/XLC_all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> compute_log_returns(df.mid)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>returns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>compute_ofi(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> compute_ofi(df)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> compute_log_returns(df.mid)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> Y.fillna(<span class="dv">0</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> restrict_common_index(X, Y)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>run_regressions(X, Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-with-arcticdb" class="level3">
<h3 class="anchored" data-anchor-id="load-with-arcticdb">Load with ArcticDB</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>closing_prices <span class="op">=</span> df.resample(<span class="st">"D"</span>).transform(<span class="st">"last"</span>).price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"closing_price"</span>] <span class="op">=</span> closing_prices</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">eval</span>(<span class="st">"pnl_to_close = (closing_price - price) * 1e4 * direction"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">eval</span>(<span class="st">"hit_ratio = (pnl_to_close &gt; 0)"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>summary_statistics <span class="op">=</span> df.groupby(by<span class="op">=</span><span class="st">"_500us_num_trades"</span>).agg(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    ppt_mean<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"mean"</span>),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    ppt_std<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"std"</span>),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    hit_ratio<span class="op">=</span>(<span class="st">"hit_ratio"</span>, <span class="st">"mean"</span>),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> summary_statistics:</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    summary_statistics[col].plot(title<span class="op">=</span>col, kind<span class="op">=</span><span class="st">"bar"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="data-analysis">Data analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_pickle(<span class="st">"../features/XLC_all"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df = df.rename(columns={'pnl_to_close':'pnl_to_close_bps', 'hit_ratio':'hit'})</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> sparse_to_dense(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> quick_marginalize(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df._500us_distinct_tickers[df._500us_distinct_tickers <span class="op">!=</span> <span class="dv">0</span>].hist(bins<span class="op">=</span><span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-43-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_decile_tags(df: pd.DataFrame) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.copy(deep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    feature_columns <span class="op">=</span> [</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>        col <span class="cf">for</span> col <span class="kw">in</span> df.columns <span class="cf">if</span> (col.startswith(<span class="st">"_"</span>) <span class="kw">and</span> (<span class="st">"neighbors"</span> <span class="kw">not</span> <span class="kw">in</span> col))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> feature_columns:</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>        df[col <span class="op">+</span> <span class="st">"_decile"</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>        mask <span class="op">=</span> df[col] <span class="op">!=</span> <span class="dv">0</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        df.loc[mask, col <span class="op">+</span> <span class="st">"_decile"</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> pd.qcut(</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>            df.loc[mask, col], <span class="dv">10</span>, labels<span class="op">=</span><span class="va">False</span>, duplicates<span class="op">=</span><span class="st">"drop"</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> add_decile_tags(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df._500us_notional_decile.hist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-46-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pnl_groupby_summaries(df: pd.DataFrame) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    decile_columns <span class="op">=</span> df.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">"decile"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> feature <span class="kw">in</span> decile_columns:</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>        display(</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>            df.groupby(feature).agg(</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                ppt_mean<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"mean"</span>),</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                ppt_std<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"std"</span>),</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                hit_ratio<span class="op">=</span>(<span class="st">"hit_ratio"</span>, <span class="st">"mean"</span>),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>pnl_groupby_summaries(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_distinct_tickers_ss_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.643133</td>
<td>61.770854</td>
<td>0.492517</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.812760</td>
<td>61.355928</td>
<td>0.488561</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-4.045905</td>
<td>56.422537</td>
<td>0.475604</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_distinct_tickers_ss_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.558275</td>
<td>61.898632</td>
<td>0.493068</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.550585</td>
<td>60.343574</td>
<td>0.483882</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-3.307661</td>
<td>53.813348</td>
<td>0.465782</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_distinct_tickers_os_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.865763</td>
<td>61.721163</td>
<td>0.490340</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3.411774</td>
<td>61.212043</td>
<td>0.526734</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.061222</td>
<td>48.415640</td>
<td>0.528889</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_distinct_tickers_os_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.800908</td>
<td>61.803316</td>
<td>0.490813</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.242885</td>
<td>58.917906</td>
<td>0.519649</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>6.493440</td>
<td>62.372479</td>
<td>0.521565</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_notional_ss_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.643133</td>
<td>61.770854</td>
<td>0.492517</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.607361</td>
<td>58.570349</td>
<td>0.485398</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.202579</td>
<td>60.670307</td>
<td>0.491769</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.459644</td>
<td>62.920067</td>
<td>0.494993</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.878494</td>
<td>59.112991</td>
<td>0.489934</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.524772</td>
<td>60.142107</td>
<td>0.498243</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.307312</td>
<td>60.133286</td>
<td>0.492372</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.883595</td>
<td>60.466047</td>
<td>0.484558</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-0.396542</td>
<td>63.332272</td>
<td>0.497536</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-1.893847</td>
<td>63.643417</td>
<td>0.474785</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-2.946519</td>
<td>62.792145</td>
<td>0.471998</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_notional_ss_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.558275</td>
<td>61.898632</td>
<td>0.493068</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-2.834461</td>
<td>59.781180</td>
<td>0.479300</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.676672</td>
<td>59.687747</td>
<td>0.492979</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.519953</td>
<td>62.552460</td>
<td>0.487992</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.882139</td>
<td>59.100325</td>
<td>0.485865</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.651685</td>
<td>58.987017</td>
<td>0.502371</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-1.792374</td>
<td>60.077847</td>
<td>0.489332</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.196554</td>
<td>60.304223</td>
<td>0.485316</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-1.320801</td>
<td>58.007007</td>
<td>0.473067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-3.139148</td>
<td>60.940594</td>
<td>0.468450</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-2.519271</td>
<td>61.252315</td>
<td>0.466683</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_notional_os_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.865763</td>
<td>61.721163</td>
<td>0.490340</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.879327</td>
<td>59.058280</td>
<td>0.528149</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.010121</td>
<td>57.983218</td>
<td>0.498677</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.351129</td>
<td>59.422650</td>
<td>0.525898</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1.636776</td>
<td>59.863851</td>
<td>0.522950</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1.631330</td>
<td>61.765873</td>
<td>0.505833</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2.777754</td>
<td>60.737137</td>
<td>0.524187</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>4.157988</td>
<td>64.720751</td>
<td>0.530263</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>5.333960</td>
<td>61.155336</td>
<td>0.529869</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>8.037108</td>
<td>64.221179</td>
<td>0.558027</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>6.992994</td>
<td>60.732431</td>
<td>0.543786</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_notional_os_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.800908</td>
<td>61.803316</td>
<td>0.490813</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.059336</td>
<td>55.607049</td>
<td>0.505418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.294143</td>
<td>58.499800</td>
<td>0.499650</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>6.056673</td>
<td>60.348068</td>
<td>0.555148</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1.044281</td>
<td>63.378526</td>
<td>0.513116</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1.258529</td>
<td>57.722351</td>
<td>0.511701</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-1.118839</td>
<td>59.609804</td>
<td>0.491517</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>1.821312</td>
<td>60.444207</td>
<td>0.517127</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>4.910002</td>
<td>55.860535</td>
<td>0.531212</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>3.334583</td>
<td>58.881109</td>
<td>0.536351</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>6.098730</td>
<td>58.564813</td>
<td>0.535583</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_num_trades_ss_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.643133</td>
<td>61.770854</td>
<td>0.492517</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.238655</td>
<td>59.964180</td>
<td>0.492070</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.698099</td>
<td>60.716125</td>
<td>0.489884</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.615163</td>
<td>61.585581</td>
<td>0.479361</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.305285</td>
<td>62.194145</td>
<td>0.500743</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-1.533414</td>
<td>62.873323</td>
<td>0.481745</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-4.590517</td>
<td>65.550885</td>
<td>0.462319</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_num_trades_ss_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.558275</td>
<td>61.898632</td>
<td>0.493068</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.224653</td>
<td>59.724444</td>
<td>0.487099</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.687725</td>
<td>61.219458</td>
<td>0.480627</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.162881</td>
<td>59.974689</td>
<td>0.488891</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-2.528587</td>
<td>59.858981</td>
<td>0.470873</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-4.276536</td>
<td>61.198019</td>
<td>0.460205</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_num_trades_os_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.865763</td>
<td>61.721163</td>
<td>0.490340</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3.258337</td>
<td>59.520706</td>
<td>0.525802</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.942281</td>
<td>61.704734</td>
<td>0.522799</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3.340639</td>
<td>64.642508</td>
<td>0.530925</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4.895420</td>
<td>67.398296</td>
<td>0.534227</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_num_trades_os_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.800908</td>
<td>61.803316</td>
<td>0.490813</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.047822</td>
<td>58.137372</td>
<td>0.515397</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.759318</td>
<td>61.019819</td>
<td>0.535476</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5.163472</td>
<td>58.253835</td>
<td>0.548089</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.474080</td>
<td>64.121195</td>
<td>0.519828</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_distinct_tickers_ss_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.631044</td>
<td>61.876847</td>
<td>0.492849</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.779497</td>
<td>61.237509</td>
<td>0.488243</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-2.715008</td>
<td>54.799858</td>
<td>0.481268</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_distinct_tickers_ss_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.530377</td>
<td>62.050068</td>
<td>0.493392</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.256457</td>
<td>60.183095</td>
<td>0.485887</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-3.746779</td>
<td>55.287757</td>
<td>0.466834</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_distinct_tickers_os_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.955352</td>
<td>61.775687</td>
<td>0.489621</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3.367115</td>
<td>60.746194</td>
<td>0.525280</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.646373</td>
<td>46.972708</td>
<td>0.543316</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_distinct_tickers_os_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.856681</td>
<td>61.841239</td>
<td>0.490261</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.167623</td>
<td>59.501224</td>
<td>0.519928</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.670279</td>
<td>52.618826</td>
<td>0.494295</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_notional_ss_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.631044</td>
<td>61.876847</td>
<td>0.492849</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.919583</td>
<td>57.741603</td>
<td>0.489872</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.322816</td>
<td>63.998686</td>
<td>0.494706</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.436388</td>
<td>62.511782</td>
<td>0.488534</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.291303</td>
<td>59.657833</td>
<td>0.498777</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.378357</td>
<td>59.337204</td>
<td>0.490922</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.268779</td>
<td>59.909848</td>
<td>0.494324</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.831407</td>
<td>59.007541</td>
<td>0.477963</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>0.530948</td>
<td>61.526356</td>
<td>0.495012</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-2.157468</td>
<td>62.839037</td>
<td>0.477545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-3.459582</td>
<td>61.809048</td>
<td>0.470608</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_notional_ss_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.530377</td>
<td>62.050068</td>
<td>0.493392</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-2.413272</td>
<td>59.922772</td>
<td>0.486446</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.585356</td>
<td>59.684135</td>
<td>0.486037</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.609443</td>
<td>60.689192</td>
<td>0.487798</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.297070</td>
<td>58.898632</td>
<td>0.497876</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.319447</td>
<td>59.990132</td>
<td>0.493737</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.547390</td>
<td>59.536933</td>
<td>0.495046</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-0.580197</td>
<td>59.334533</td>
<td>0.486146</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-2.790066</td>
<td>58.038621</td>
<td>0.471752</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-1.739835</td>
<td>60.676215</td>
<td>0.477906</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-2.677771</td>
<td>61.197072</td>
<td>0.460859</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_notional_os_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.955352</td>
<td>61.775687</td>
<td>0.489621</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.878289</td>
<td>59.304286</td>
<td>0.512208</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.531704</td>
<td>57.798467</td>
<td>0.518673</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.218857</td>
<td>59.089928</td>
<td>0.514667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2.426727</td>
<td>59.789895</td>
<td>0.528364</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2.835986</td>
<td>60.323044</td>
<td>0.522732</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2.523363</td>
<td>61.007708</td>
<td>0.520747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>5.998150</td>
<td>61.729782</td>
<td>0.536164</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>3.395071</td>
<td>61.110598</td>
<td>0.523200</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>7.043703</td>
<td>62.970041</td>
<td>0.540587</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>6.623635</td>
<td>60.445671</td>
<td>0.540373</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_notional_os_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.856681</td>
<td>61.841239</td>
<td>0.490261</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.557025</td>
<td>56.218909</td>
<td>0.497423</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.529107</td>
<td>60.984008</td>
<td>0.505389</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.936321</td>
<td>58.918019</td>
<td>0.532927</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.329554</td>
<td>64.498620</td>
<td>0.516046</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.933136</td>
<td>58.690229</td>
<td>0.501524</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2.259697</td>
<td>57.958455</td>
<td>0.523492</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>3.354150</td>
<td>59.645778</td>
<td>0.528530</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2.248975</td>
<td>57.914844</td>
<td>0.517985</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>3.337420</td>
<td>58.288166</td>
<td>0.535091</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>6.366916</td>
<td>59.017748</td>
<td>0.531927</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_num_trades_ss_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.631044</td>
<td>61.876847</td>
<td>0.492849</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.454989</td>
<td>60.118915</td>
<td>0.490237</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.418848</td>
<td>61.038676</td>
<td>0.493222</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.768238</td>
<td>60.872930</td>
<td>0.488464</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.036106</td>
<td>61.070397</td>
<td>0.493534</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.350965</td>
<td>62.047722</td>
<td>0.493732</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-1.308659</td>
<td>60.814645</td>
<td>0.486699</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-4.521073</td>
<td>62.717787</td>
<td>0.459659</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_num_trades_ss_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.530377</td>
<td>62.050068</td>
<td>0.493392</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.268697</td>
<td>59.373215</td>
<td>0.489180</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.224155</td>
<td>59.625411</td>
<td>0.481525</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.022584</td>
<td>61.107965</td>
<td>0.487728</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.681189</td>
<td>60.528049</td>
<td>0.489369</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-1.329320</td>
<td>59.330652</td>
<td>0.482285</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-4.449813</td>
<td>60.671548</td>
<td>0.452751</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_num_trades_os_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.955352</td>
<td>61.775687</td>
<td>0.489621</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3.234752</td>
<td>58.724422</td>
<td>0.524910</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.877069</td>
<td>60.792566</td>
<td>0.518821</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.644395</td>
<td>63.800922</td>
<td>0.530985</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4.042088</td>
<td>62.450491</td>
<td>0.529729</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>4.624610</td>
<td>66.430469</td>
<td>0.532577</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_num_trades_os_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.856681</td>
<td>61.841239</td>
<td>0.490261</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.001831</td>
<td>58.755650</td>
<td>0.515055</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.804954</td>
<td>60.104695</td>
<td>0.520194</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.274179</td>
<td>60.081775</td>
<td>0.534969</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4.023642</td>
<td>61.206150</td>
<td>0.529127</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_num_trades_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.624363</td>
<td>62.073346</td>
<td>0.492292</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.771295</td>
<td>59.199156</td>
<td>0.491436</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.305855</td>
<td>59.160893</td>
<td>0.498517</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.780987</td>
<td>60.360073</td>
<td>0.488227</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.786848</td>
<td>59.707173</td>
<td>0.494127</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.901237</td>
<td>61.304476</td>
<td>0.486110</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-1.394785</td>
<td>62.053705</td>
<td>0.487051</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.862932</td>
<td>63.895073</td>
<td>0.482005</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_num_trades_ss_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.583798</td>
<td>61.985974</td>
<td>0.492952</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.622676</td>
<td>59.481844</td>
<td>0.491386</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.508815</td>
<td>60.361324</td>
<td>0.493580</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.882116</td>
<td>59.136526</td>
<td>0.487251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.851718</td>
<td>59.018502</td>
<td>0.494147</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.926985</td>
<td>61.954130</td>
<td>0.488736</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-1.763713</td>
<td>62.105273</td>
<td>0.480357</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-4.007048</td>
<td>63.285106</td>
<td>0.462489</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_num_trades_os_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.929842</td>
<td>61.809814</td>
<td>0.489757</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.374314</td>
<td>58.810657</td>
<td>0.516661</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.998964</td>
<td>60.442060</td>
<td>0.527387</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3.344102</td>
<td>61.183125</td>
<td>0.545944</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.038497</td>
<td>60.106806</td>
<td>0.535006</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>4.635688</td>
<td>67.032428</td>
<td>0.521683</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_num_trades_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.622813</td>
<td>61.971757</td>
<td>0.492287</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.817132</td>
<td>59.319436</td>
<td>0.492457</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.253124</td>
<td>59.864659</td>
<td>0.490510</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.021069</td>
<td>61.741601</td>
<td>0.492768</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.182568</td>
<td>60.471182</td>
<td>0.488137</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-1.603393</td>
<td>59.761835</td>
<td>0.486254</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-2.526486</td>
<td>61.173489</td>
<td>0.473428</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_num_trades_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.664331</td>
<td>61.829221</td>
<td>0.492096</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.474160</td>
<td>59.376197</td>
<td>0.493041</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.504745</td>
<td>60.225088</td>
<td>0.492815</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.437510</td>
<td>61.429477</td>
<td>0.485275</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.241796</td>
<td>61.766851</td>
<td>0.500943</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-1.043944</td>
<td>62.469156</td>
<td>0.490358</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-1.752811</td>
<td>67.079999</td>
<td>0.483199</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_notional_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.624363</td>
<td>62.073346</td>
<td>0.492292</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.761678</td>
<td>60.174418</td>
<td>0.483405</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.587186</td>
<td>59.107845</td>
<td>0.498931</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.562783</td>
<td>61.054809</td>
<td>0.496260</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.172567</td>
<td>59.212871</td>
<td>0.487761</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.328366</td>
<td>59.735689</td>
<td>0.500334</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.805646</td>
<td>60.452556</td>
<td>0.490416</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.150675</td>
<td>58.426758</td>
<td>0.487176</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-0.985196</td>
<td>60.300657</td>
<td>0.495292</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-0.796025</td>
<td>60.643618</td>
<td>0.483119</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-1.383282</td>
<td>63.000604</td>
<td>0.483453</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_notional_ss_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.583798</td>
<td>61.985974</td>
<td>0.492952</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-2.593199</td>
<td>59.694679</td>
<td>0.480081</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.474464</td>
<td>59.605587</td>
<td>0.493179</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.356999</td>
<td>61.088360</td>
<td>0.493008</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.532972</td>
<td>59.912918</td>
<td>0.492108</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.054631</td>
<td>59.562982</td>
<td>0.498121</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.277186</td>
<td>59.295282</td>
<td>0.500432</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.445407</td>
<td>58.426776</td>
<td>0.482279</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-1.452874</td>
<td>61.897539</td>
<td>0.489251</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-1.438291</td>
<td>61.036911</td>
<td>0.474517</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-2.950965</td>
<td>63.156705</td>
<td>0.471510</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_notional_os_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.929842</td>
<td>61.809814</td>
<td>0.489757</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.651053</td>
<td>57.549163</td>
<td>0.496467</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.633741</td>
<td>59.928029</td>
<td>0.506411</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.459156</td>
<td>60.192744</td>
<td>0.537383</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.270969</td>
<td>59.628485</td>
<td>0.503838</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1.614457</td>
<td>58.817251</td>
<td>0.506260</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2.105182</td>
<td>61.321893</td>
<td>0.522257</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2.762148</td>
<td>62.013939</td>
<td>0.519637</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>4.511833</td>
<td>58.598578</td>
<td>0.534283</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>5.557047</td>
<td>60.705294</td>
<td>0.552326</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>7.107907</td>
<td>61.111440</td>
<td>0.540800</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_notional_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.622813</td>
<td>61.971757</td>
<td>0.492287</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.971418</td>
<td>59.453257</td>
<td>0.483909</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.750454</td>
<td>59.641926</td>
<td>0.499896</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.302845</td>
<td>61.484574</td>
<td>0.500570</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.847975</td>
<td>59.435802</td>
<td>0.489428</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.472649</td>
<td>58.862096</td>
<td>0.499119</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-1.783717</td>
<td>60.445102</td>
<td>0.492045</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-0.741502</td>
<td>60.202519</td>
<td>0.490102</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-1.136949</td>
<td>58.666341</td>
<td>0.481946</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-1.569738</td>
<td>59.665126</td>
<td>0.482171</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-1.405234</td>
<td>60.765520</td>
<td>0.478022</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_notional_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.664331</td>
<td>61.829221</td>
<td>0.492096</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.299757</td>
<td>59.059844</td>
<td>0.495386</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.405030</td>
<td>60.212036</td>
<td>0.494756</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.276251</td>
<td>62.615726</td>
<td>0.492496</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.141867</td>
<td>58.157430</td>
<td>0.487067</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.305562</td>
<td>60.263198</td>
<td>0.497576</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.736978</td>
<td>60.128309</td>
<td>0.494151</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.632006</td>
<td>60.556523</td>
<td>0.482265</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-0.244806</td>
<td>62.535670</td>
<td>0.496225</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-1.186544</td>
<td>62.135430</td>
<td>0.484081</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-0.986609</td>
<td>63.429730</td>
<td>0.486810</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_distinct_tickers_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.624363</td>
<td>62.073346</td>
<td>0.492292</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.227008</td>
<td>59.633737</td>
<td>0.488654</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.224429</td>
<td>62.098079</td>
<td>0.493227</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.876075</td>
<td>62.277790</td>
<td>0.491838</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1.765962</td>
<td>60.542632</td>
<td>0.507381</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_distinct_tickers_ss_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.583798</td>
<td>61.985974</td>
<td>0.492952</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.774826</td>
<td>60.053791</td>
<td>0.490555</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.641327</td>
<td>61.941860</td>
<td>0.477445</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-4.015630</td>
<td>61.446165</td>
<td>0.468617</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_distinct_tickers_os_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.929842</td>
<td>61.809814</td>
<td>0.489757</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.533058</td>
<td>59.730576</td>
<td>0.520881</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5.133906</td>
<td>63.005490</td>
<td>0.532945</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_distinct_tickers_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.622813</td>
<td>61.971757</td>
<td>0.492287</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.219873</td>
<td>59.934065</td>
<td>0.488896</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.745686</td>
<td>59.213199</td>
<td>0.498069</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_250us_distinct_tickers_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.664331</td>
<td>61.829221</td>
<td>0.492096</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.205755</td>
<td>60.666768</td>
<td>0.487608</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.404990</td>
<td>62.575532</td>
<td>0.512286</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4.268441</td>
<td>63.900911</td>
<td>0.537923</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_num_trades_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.620705</td>
<td>62.241559</td>
<td>0.492495</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.794000</td>
<td>59.759304</td>
<td>0.492391</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.552811</td>
<td>59.919713</td>
<td>0.492704</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.243655</td>
<td>60.074425</td>
<td>0.485892</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.369341</td>
<td>59.229205</td>
<td>0.494718</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.232508</td>
<td>61.109111</td>
<td>0.490330</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.400918</td>
<td>59.191122</td>
<td>0.494637</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.373648</td>
<td>60.658896</td>
<td>0.487495</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-1.981550</td>
<td>63.073542</td>
<td>0.478495</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_num_trades_ss_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.561270</td>
<td>62.172412</td>
<td>0.493420</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.848067</td>
<td>59.671323</td>
<td>0.489566</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.020212</td>
<td>60.087895</td>
<td>0.497073</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.380355</td>
<td>59.710729</td>
<td>0.486354</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.893635</td>
<td>59.555662</td>
<td>0.507159</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-1.227093</td>
<td>60.816321</td>
<td>0.485904</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.353219</td>
<td>60.514143</td>
<td>0.490522</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.176014</td>
<td>61.057991</td>
<td>0.485871</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-4.356785</td>
<td>61.385492</td>
<td>0.455455</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_num_trades_os_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-1.046610</td>
<td>61.879410</td>
<td>0.488671</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.598178</td>
<td>58.831561</td>
<td>0.520584</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.388084</td>
<td>59.694840</td>
<td>0.507341</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.737855</td>
<td>59.678416</td>
<td>0.530951</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.696714</td>
<td>59.989764</td>
<td>0.533094</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>3.759433</td>
<td>61.863665</td>
<td>0.536187</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>4.039673</td>
<td>64.946298</td>
<td>0.526656</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_num_trades_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.587478</td>
<td>62.125014</td>
<td>0.492544</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.113409</td>
<td>59.367993</td>
<td>0.491887</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.997767</td>
<td>58.838169</td>
<td>0.487190</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.869232</td>
<td>60.666104</td>
<td>0.489730</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.052012</td>
<td>60.649465</td>
<td>0.493777</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.762628</td>
<td>59.659274</td>
<td>0.493069</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-2.445965</td>
<td>61.347069</td>
<td>0.468964</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_num_trades_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.668649</td>
<td>61.925253</td>
<td>0.492249</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.538032</td>
<td>59.952511</td>
<td>0.491761</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.299802</td>
<td>60.643783</td>
<td>0.496218</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.287512</td>
<td>60.394182</td>
<td>0.485155</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.212191</td>
<td>60.688700</td>
<td>0.494354</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-1.146913</td>
<td>61.073612</td>
<td>0.484358</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.092052</td>
<td>61.518328</td>
<td>0.497092</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-2.373215</td>
<td>63.827114</td>
<td>0.479336</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_notional_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.620705</td>
<td>62.241559</td>
<td>0.492495</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.737734</td>
<td>59.449735</td>
<td>0.486342</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.074176</td>
<td>62.670226</td>
<td>0.492326</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.025192</td>
<td>60.625263</td>
<td>0.499924</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.614110</td>
<td>60.044256</td>
<td>0.496633</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.801568</td>
<td>59.466447</td>
<td>0.493838</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.111053</td>
<td>58.976801</td>
<td>0.496239</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.006608</td>
<td>57.990565</td>
<td>0.481425</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-0.502523</td>
<td>59.481311</td>
<td>0.492872</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-0.756644</td>
<td>61.013727</td>
<td>0.485783</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-1.766824</td>
<td>62.147439</td>
<td>0.479265</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_notional_ss_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.561270</td>
<td>62.172412</td>
<td>0.493420</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.863055</td>
<td>58.888619</td>
<td>0.486284</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.249291</td>
<td>62.612207</td>
<td>0.488324</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.189270</td>
<td>60.810309</td>
<td>0.496620</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.328625</td>
<td>59.565858</td>
<td>0.498071</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.872963</td>
<td>59.632551</td>
<td>0.492663</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.384466</td>
<td>59.283316</td>
<td>0.497085</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.646605</td>
<td>57.275756</td>
<td>0.480803</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-0.432175</td>
<td>60.536473</td>
<td>0.485001</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-1.196030</td>
<td>61.456614</td>
<td>0.480045</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-3.407939</td>
<td>61.671914</td>
<td>0.468860</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_notional_os_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-1.046610</td>
<td>61.879410</td>
<td>0.488671</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.608009</td>
<td>57.868357</td>
<td>0.502373</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.213149</td>
<td>58.919654</td>
<td>0.515229</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.964962</td>
<td>62.022977</td>
<td>0.516856</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1.005730</td>
<td>60.088004</td>
<td>0.519020</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2.178224</td>
<td>59.371388</td>
<td>0.516182</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>3.162189</td>
<td>60.533363</td>
<td>0.528195</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>3.360963</td>
<td>59.145323</td>
<td>0.520612</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>3.825312</td>
<td>59.067154</td>
<td>0.533107</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>4.677211</td>
<td>59.846586</td>
<td>0.536342</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>6.527061</td>
<td>61.477747</td>
<td>0.536865</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_notional_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.587478</td>
<td>62.125014</td>
<td>0.492544</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.903612</td>
<td>59.641853</td>
<td>0.486272</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.577016</td>
<td>60.150047</td>
<td>0.491786</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.143377</td>
<td>61.440408</td>
<td>0.495120</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.107671</td>
<td>59.068153</td>
<td>0.498640</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.235300</td>
<td>59.691610</td>
<td>0.497094</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.917223</td>
<td>59.612335</td>
<td>0.495474</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-0.553782</td>
<td>59.167483</td>
<td>0.488227</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-2.063076</td>
<td>58.191175</td>
<td>0.482530</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-1.035980</td>
<td>59.779924</td>
<td>0.483736</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-1.277087</td>
<td>60.858042</td>
<td>0.474165</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_notional_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.668649</td>
<td>61.925253</td>
<td>0.492249</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.785802</td>
<td>59.048124</td>
<td>0.495797</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.278989</td>
<td>63.251210</td>
<td>0.497261</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.688745</td>
<td>61.896634</td>
<td>0.489579</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-0.574269</td>
<td>59.815153</td>
<td>0.488596</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.589105</td>
<td>58.980227</td>
<td>0.496314</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.192829</td>
<td>59.345051</td>
<td>0.496417</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-1.358694</td>
<td>59.674096</td>
<td>0.481068</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>0.593934</td>
<td>60.252274</td>
<td>0.495297</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-1.503131</td>
<td>62.581222</td>
<td>0.485840</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-1.802396</td>
<td>62.680478</td>
<td>0.481171</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_distinct_tickers_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.620705</td>
<td>62.241559</td>
<td>0.492495</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.092466</td>
<td>59.828786</td>
<td>0.489363</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.211530</td>
<td>61.456763</td>
<td>0.483649</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.552845</td>
<td>61.253291</td>
<td>0.495493</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.813567</td>
<td>60.707730</td>
<td>0.500691</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>1.154696</td>
<td>59.047758</td>
<td>0.503376</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_distinct_tickers_ss_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.561270</td>
<td>62.172412</td>
<td>0.493420</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.639238</td>
<td>59.944723</td>
<td>0.491008</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.763453</td>
<td>61.602485</td>
<td>0.478763</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-2.008124</td>
<td>63.390048</td>
<td>0.480476</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-3.581870</td>
<td>54.043554</td>
<td>0.468186</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_distinct_tickers_os_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-1.046610</td>
<td>61.879410</td>
<td>0.488671</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.566729</td>
<td>59.844122</td>
<td>0.521527</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4.542225</td>
<td>62.615163</td>
<td>0.530370</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.876447</td>
<td>54.978770</td>
<td>0.525470</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_distinct_tickers_af_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.587478</td>
<td>62.125014</td>
<td>0.492544</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.296133</td>
<td>59.827035</td>
<td>0.488025</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.072548</td>
<td>61.747507</td>
<td>0.497917</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.362832</td>
<td>55.800555</td>
<td>0.495359</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_distinct_tickers_bf_decile</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.668649</td>
<td>61.925253</td>
<td>0.492249</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.307315</td>
<td>60.883753</td>
<td>0.486054</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.477785</td>
<td>60.123702</td>
<td>0.513252</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2.324241</td>
<td>60.065732</td>
<td>0.519392</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_grouped_statistics(group) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    col1 <span class="op">=</span> <span class="st">"ppt_mean"</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    col2 <span class="op">=</span> <span class="st">"hit_ratio"</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    fig, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.arange(<span class="bu">len</span>(group.index))</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    ax1.bar(x <span class="op">-</span> width <span class="op">/</span> <span class="dv">2</span>, group[col1], width, color<span class="op">=</span><span class="st">"b"</span>, label<span class="op">=</span>col1)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    ax1.set_xlabel(<span class="st">"feature deciles"</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    ax1.set_ylabel(col1, color<span class="op">=</span><span class="st">"b"</span>)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">"y"</span>, labelcolor<span class="op">=</span><span class="st">"b"</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> ax1.twinx()</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    ax2.bar(x <span class="op">+</span> width <span class="op">/</span> <span class="dv">2</span>, group[col2] <span class="op">-</span> <span class="fl">0.5</span>, width, bottom<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">"r"</span>, label<span class="op">=</span>col2)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylabel(col2, color<span class="op">=</span><span class="st">"r"</span>)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    ax2.tick_params(axis<span class="op">=</span><span class="st">"y"</span>, labelcolor<span class="op">=</span><span class="st">"r"</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    plt.xticks(x, group.index)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_group(df, feature_name):</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df.groupby(feature_name).agg(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>        ppt_mean<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"mean"</span>),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>        ppt_std<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"std"</span>),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>        hit_ratio<span class="op">=</span>(<span class="st">"hit_ratio"</span>, <span class="st">"mean"</span>),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>plot_grouped_statistics(get_group(df, <span class="st">"_250us_notional_os_decile"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-51-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>plot_grouped_statistics(get_group(df, <span class="st">"_250us_notional_ss_decile"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-52-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>feature_name <span class="op">=</span> <span class="st">"_250us_notional_os_decile"</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    df.query(<span class="ss">f"</span><span class="sc">{</span>feature_name<span class="sc">}</span><span class="ss"> == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>).groupby(</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: x.date()</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    ).pnl_to_close.mean().plot(ax<span class="op">=</span>ax, label<span class="op">=</span><span class="ss">f"decile </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-53-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>feature_name <span class="op">=</span> <span class="st">"_250us_notional_os_decile"</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    df.query(<span class="ss">f"</span><span class="sc">{</span>feature_name<span class="sc">}</span><span class="ss"> == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>).groupby(</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: x.date()</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    ).pnl_to_close.<span class="bu">sum</span>().cumsum().plot(ax<span class="op">=</span>ax, label<span class="op">=</span><span class="ss">f"decile </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-54-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>feature_name <span class="op">=</span> <span class="st">"_250us_notional_os_decile"</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    df.query(<span class="ss">f"</span><span class="sc">{</span>feature_name<span class="sc">}</span><span class="ss"> == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>).groupby(</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> x: x.date()</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    ).pnl_to_close.mean().cumsum().plot(ax<span class="op">=</span>ax, label<span class="op">=</span><span class="ss">f"decile </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-55-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    sharpe <span class="op">=</span> (</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>        df.query(<span class="ss">f"</span><span class="sc">{</span>feature_name<span class="sc">}</span><span class="ss"> == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>).pnl_to_close.mean()</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">/</span> df.query(<span class="ss">f"</span><span class="sc">{</span>feature_name<span class="sc">}</span><span class="ss"> == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>).pnl_to_close.std()</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"sharpe for decile </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>sharpe<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sharpe for decile 1: 0.01131299019947174
sharpe for decile 2: 0.010575027888550928
sharpe for decile 3: 0.040854689142390745
sharpe for decile 4: 0.004544291490442815
sharpe for decile 5: 0.027448700970349613
sharpe for decile 6: 0.03433001638137391
sharpe for decile 7: 0.04454075665938627
sharpe for decile 8: 0.07699561228596234
sharpe for decile 9: 0.09154139206805635
sharpe for decile 10: 0.1163105720546142</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: denoise by suctracting SPOOS return</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>df_grouped <span class="op">=</span> df.groupby(df.index.date)[<span class="st">"pnl_to_close"</span>].<span class="bu">sum</span>()</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df_grouped.plot(title<span class="op">=</span><span class="st">"Average PNL (bps) by Day"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: title={'center': 'Average PNL (bps) by Day'}&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-58-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df_grouped[df_grouped <span class="op">&gt;</span> <span class="dv">200_000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>2021-02-23    210520.562122
2021-02-24    247849.271511
2021-12-15    270619.406684
Name: pnl_to_close, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>df_grouped[df_grouped <span class="op">&lt;</span> <span class="op">-</span><span class="dv">200_000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>2021-01-27   -297916.178854
2021-02-26   -393937.111535
2021-03-03   -203526.073030
2021-03-16   -213817.381550
2021-12-01   -333587.389163
Name: pnl_to_close, dtype: float64</code></pre>
</div>
</div>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section"></h4>
<p>OFI</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_count_histograms_per_tag(df, feature_name) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> pd.concat(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>            df.query(<span class="ss">f"</span><span class="sc">{</span>feature_name<span class="sc">}</span><span class="ss"> == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>).resample(<span class="st">"5min"</span>).size()</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>        axis<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    ).fillna(<span class="dv">0</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> column <span class="kw">in</span> X.columns:</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> X[column]</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># filter non-iso</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x[x <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>        plt.hist(x, bins<span class="op">=</span>np.arange(x.<span class="bu">min</span>(), x.<span class="bu">max</span>()), density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="ss">f"Histogram of </span><span class="sc">{</span>column<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(column)</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>        plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>plot_count_histograms_per_tag(df, <span class="st">"_250us_notional_os_decile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-7.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-8.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-9.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-10.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-62-output-11.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_log_returns2(mid):</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    zz <span class="op">=</span> pd.DataFrame(mid)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    markouts_str <span class="op">=</span> [<span class="st">"30S"</span>, <span class="st">"1min"</span>, <span class="st">"2min"</span>]</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    Markout <span class="op">=</span> namedtuple(<span class="st">"Markout"</span>, [<span class="st">"str"</span>, <span class="st">"int"</span>])</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    markouts <span class="op">=</span> [Markout(x, markout_to_int(x)) <span class="cf">for</span> x <span class="kw">in</span> markouts_str]</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> markout <span class="kw">in</span> markouts:</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>        zz[<span class="ss">f"_</span><span class="sc">{</span>markout<span class="sc">.</span><span class="bu">str</span><span class="sc">}</span><span class="ss">"</span>] <span class="op">=</span> zz.mid.shift(<span class="op">-</span>markout.<span class="bu">int</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    logs <span class="op">=</span> np.log(zz)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    logs <span class="op">=</span> logs.resample(<span class="st">"5min"</span>, label<span class="op">=</span><span class="st">"right"</span>, closed<span class="op">=</span><span class="st">"right"</span>).last()</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># not sure how to drop all resampled buckets where there was a NaN before</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for now simply drop last row of resampled dataframe</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    logs <span class="op">=</span> logs.iloc[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>    markouts_columns <span class="op">=</span> logs.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">"^_"</span>).columns.to_list()</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> markout_column <span class="kw">in</span> markouts_columns:</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>        logs[markout_column] <span class="op">=</span> logs[markout_column] <span class="op">-</span> logs[<span class="st">"mid"</span>]</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># markouts_columns</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># markouts_columns = logs.filter(regex="^_").columns.to_list()</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for markout_column in markouts_columns:</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     logs[markout_column] = logs[markout_column] - logs['mid']</span></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>    logs[<span class="st">"contemp"</span>] <span class="op">=</span> logs.mid <span class="op">-</span> logs.mid.shift(<span class="dv">1</span>)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>    logs.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>    logs <span class="op">=</span> logs.drop(<span class="st">"mid"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>compute_log_returns(df.mid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">_30S</th>
<th data-quarto-table-cell-role="th">_1min</th>
<th data-quarto-table-cell-role="th">_2min</th>
<th data-quarto-table-cell-role="th">contemp</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:40:00</td>
<td>-0.000519</td>
<td>-0.000445</td>
<td>-0.000519</td>
<td>-0.001631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:45:00</td>
<td>-0.000074</td>
<td>-0.000074</td>
<td>-0.000149</td>
<td>-0.002154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:50:00</td>
<td>-0.000074</td>
<td>-0.000074</td>
<td>-0.000149</td>
<td>0.000297</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:55:00</td>
<td>0.000670</td>
<td>0.000670</td>
<td>0.000596</td>
<td>-0.001934</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 10:00:00</td>
<td>0.000075</td>
<td>0.000075</td>
<td>0.000075</td>
<td>-0.001640</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:35:00</td>
<td>0.000064</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>-0.001536</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:40:00</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>0.000000</td>
<td>-0.000705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:45:00</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>0.000320</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:50:00</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>-0.000449</td>
<td>-0.000705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:55:00</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>-0.003340</td>
</tr>
</tbody>
</table>

<p>18426 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>compute_log_returns2(df.mid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">_30S</th>
<th data-quarto-table-cell-role="th">_1min</th>
<th data-quarto-table-cell-role="th">_2min</th>
<th data-quarto-table-cell-role="th">contemp</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:40:00</td>
<td>-0.000519</td>
<td>-0.000445</td>
<td>-0.000519</td>
<td>-0.001631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:45:00</td>
<td>-0.000074</td>
<td>-0.000074</td>
<td>-0.000149</td>
<td>-0.002154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:50:00</td>
<td>-0.000074</td>
<td>-0.000074</td>
<td>-0.000149</td>
<td>0.000297</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:55:00</td>
<td>0.000670</td>
<td>0.000670</td>
<td>0.000596</td>
<td>-0.001934</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 10:00:00</td>
<td>0.000075</td>
<td>0.000075</td>
<td>0.000075</td>
<td>-0.001640</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:35:00</td>
<td>0.000064</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>-0.001536</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:40:00</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>0.000000</td>
<td>-0.000705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:45:00</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>0.000320</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:50:00</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>-0.000449</td>
<td>-0.000705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:55:00</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>-0.003340</td>
</tr>
</tbody>
</table>

<p>18426 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.concat(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    [compute_ofi(df.query(<span class="ss">f"_250us_notional_os_decile == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>)],</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X.fillna(<span class="dv">0</span>)  <span class="co"># for no order flow, set 0 OFI</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>X.columns <span class="op">=</span> [<span class="ss">f"_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">11</span>)]</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> compute_log_returns2(df.mid)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> restrict_common_index(X, Y)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>run_regressions(X, Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">r2</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">intercept</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">target_markout</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">_30S</td>
<td>0.001811</td>
<td>[2.200118744539078e-05, -3.6208686711013614e-0...</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">_1min</td>
<td>0.001893</td>
<td>[2.6182811554683554e-05, -4.04457648403342e-06...</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">_2min</td>
<td>0.001680</td>
<td>[2.9314378749474886e-05, -2.590898591698459e-0...</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">contemp</td>
<td>0.015981</td>
<td>[-0.00025494788194808634, -3.750410431682322e-...</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.concat(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    [compute_ofi(df.query(<span class="ss">f"_250us_notional_os_decile == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>)],</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X.fillna(<span class="dv">0</span>)  <span class="co"># for no order flow, set 0 OFI</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>X.columns <span class="op">=</span> [<span class="ss">f"_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">11</span>)]</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> compute_log_returns2(df.mid)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> restrict_common_index(X, Y)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Y = Y.contemp</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> Y._1min</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(Y, X)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit()</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>results.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>_1min</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.002</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.001</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>3.193</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Tue, 21 Nov 2023</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>0.000239</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>14:28:56</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>1.0592e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>18426</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>-2.118e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>18414</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>-2.117e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>11</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">const</td>
<td>3.282e-06</td>
<td>7.42e-06</td>
<td>0.442</td>
<td>0.658</td>
<td>-1.13e-05</td>
<td>1.78e-05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">_0</td>
<td>2.392e-05</td>
<td>1.51e-05</td>
<td>1.585</td>
<td>0.113</td>
<td>-5.66e-06</td>
<td>5.35e-05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">_1</td>
<td>-3.565e-06</td>
<td>1.48e-05</td>
<td>-0.241</td>
<td>0.809</td>
<td>-3.25e-05</td>
<td>2.54e-05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">_2</td>
<td>-3.361e-06</td>
<td>1.43e-05</td>
<td>-0.235</td>
<td>0.814</td>
<td>-3.14e-05</td>
<td>2.47e-05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">_3</td>
<td>-2.284e-05</td>
<td>1.43e-05</td>
<td>-1.603</td>
<td>0.109</td>
<td>-5.08e-05</td>
<td>5.1e-06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">_4</td>
<td>1.13e-05</td>
<td>1.41e-05</td>
<td>0.801</td>
<td>0.423</td>
<td>-1.64e-05</td>
<td>3.89e-05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">_5</td>
<td>2.346e-05</td>
<td>1.41e-05</td>
<td>1.660</td>
<td>0.097</td>
<td>-4.24e-06</td>
<td>5.12e-05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">_6</td>
<td>-3.896e-05</td>
<td>1.44e-05</td>
<td>-2.703</td>
<td>0.007</td>
<td>-6.72e-05</td>
<td>-1.07e-05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">_7</td>
<td>3.936e-06</td>
<td>1.43e-05</td>
<td>0.275</td>
<td>0.783</td>
<td>-2.41e-05</td>
<td>3.19e-05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">_8</td>
<td>-2.099e-05</td>
<td>1.46e-05</td>
<td>-1.438</td>
<td>0.151</td>
<td>-4.96e-05</td>
<td>7.63e-06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">_9</td>
<td>-5.749e-05</td>
<td>1.5e-05</td>
<td>-3.832</td>
<td>0.000</td>
<td>-8.69e-05</td>
<td>-2.81e-05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">_10</td>
<td>7.132e-06</td>
<td>1.56e-05</td>
<td>0.458</td>
<td>0.647</td>
<td>-2.34e-05</td>
<td>3.77e-05</td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>9515.212</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.992</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>56763414.673</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>0.621</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>274.907</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>3.10</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_ofi_histograms_per_tag(df, feature_name) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> pd.concat(</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>        [compute_ofi(df.query(<span class="ss">f"</span><span class="sc">{</span>feature_name<span class="sc">}</span><span class="ss"> == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>)], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X.fillna(<span class="dv">0</span>)  <span class="co"># for no order flow, set 0 OFI</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    X.columns <span class="op">=</span> [<span class="ss">f"_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">11</span>)]</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> compute_log_returns(df.mid)</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    X, Y <span class="op">=</span> restrict_common_index(X, Y)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> column <span class="kw">in</span> X.columns:</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>        plt.hist(X[column], bins<span class="op">=</span><span class="dv">30</span>, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="ss">f"Histogram of </span><span class="sc">{</span>column<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(column)</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>        plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>plot_ofi_histograms_per_tag(df, <span class="st">"_250us_notional_ss_decile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-7.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-8.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-9.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-10.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-69-output-11.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unconditional ofi</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> compute_ofi(df)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X.fillna(<span class="dv">0</span>)  <span class="co"># for no order flow, set 0 OFI</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> compute_log_returns2(df.mid)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> restrict_common_index(X, Y)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Y = Y.contemp</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> Y._1min</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(Y, X)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit()</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>results.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<caption>OLS Regression Results</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dep. Variable:</td>
<td>_1min</td>
<td data-quarto-table-cell-role="th">R-squared:</td>
<td>0.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Model:</td>
<td>OLS</td>
<td data-quarto-table-cell-role="th">Adj. R-squared:</td>
<td>0.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Method:</td>
<td>Least Squares</td>
<td data-quarto-table-cell-role="th">F-statistic:</td>
<td>1.101</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Date:</td>
<td>Tue, 21 Nov 2023</td>
<td data-quarto-table-cell-role="th">Prob (F-statistic):</td>
<td>0.294</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Time:</td>
<td>14:29:16</td>
<td data-quarto-table-cell-role="th">Log-Likelihood:</td>
<td>1.0590e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">No. Observations:</td>
<td>18426</td>
<td data-quarto-table-cell-role="th">AIC:</td>
<td>-2.118e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Df Residuals:</td>
<td>18424</td>
<td data-quarto-table-cell-role="th">BIC:</td>
<td>-2.118e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Df Model:</td>
<td>1</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Covariance Type:</td>
<td>nonrobust</td>
<td data-quarto-table-cell-role="th"></td>
<td></td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td></td>
<td data-quarto-table-cell-role="th">coef</td>
<td data-quarto-table-cell-role="th">std err</td>
<td data-quarto-table-cell-role="th">t</td>
<td data-quarto-table-cell-role="th">P&gt;|t|</td>
<td data-quarto-table-cell-role="th">[0.025</td>
<td data-quarto-table-cell-role="th">0.975]</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">const</td>
<td>1.898e-05</td>
<td>5.89e-06</td>
<td>3.222</td>
<td>0.001</td>
<td>7.43e-06</td>
<td>3.05e-05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ofi</td>
<td>1.606e-05</td>
<td>1.53e-05</td>
<td>1.049</td>
<td>0.294</td>
<td>-1.39e-05</td>
<td>4.6e-05</td>
</tr>
</tbody>
</table>
<table class="simpletable table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Omnibus:</td>
<td>9944.354</td>
<td data-quarto-table-cell-role="th">Durbin-Watson:</td>
<td>1.989</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Prob(Omnibus):</td>
<td>0.000</td>
<td data-quarto-table-cell-role="th">Jarque-Bera (JB):</td>
<td>57145617.692</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Skew:</td>
<td>0.766</td>
<td data-quarto-table-cell-role="th">Prob(JB):</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Kurtosis:</td>
<td>275.819</td>
<td data-quarto-table-cell-role="th">Cond. No.</td>
<td>2.72</td>
</tr>
</tbody>
</table>
<br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</div>
</div>
</section>
<section id="preliminary-evidence-groupby-by-quantile-by-year" class="level4">
<h4 class="anchored" data-anchor-id="preliminary-evidence-groupby-by-quantile-by-year">Preliminary evidence groupby by quantile by year</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>):</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    df.query(<span class="ss">f"_500us_notional_os_decile == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>).pnl_to_close.cumsum().plot(</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>ax, label<span class="op">=</span><span class="ss">f"decile </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-72-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    df.query(<span class="ss">f"_500us_notional_os_decile == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>).pnl_to_close.cumsum().plot(</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>ax, label<span class="op">=</span><span class="ss">f"decile </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-73-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">eval</span>(<span class="st">"ret = pnl_to_close / 1e4"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df.query(<span class="ss">f"_500us_notional_os_decile == 10"</span>).ret.copy(deep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>daily_returns <span class="op">=</span> df1.groupby(df1.index.date).mean()</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>daily_returns.mean() <span class="op">/</span> daily_returns.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.01860449561186662</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    df.query(<span class="ss">f"_500us_notional_os_decile == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>).ret.cumprod().plot(</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>ax, label<span class="op">=</span><span class="ss">f"decile </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="06_etf_pipeline_s3_files/figure-html/cell-76-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>):</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    df.query(<span class="ss">f"_500us_notional_os_decile == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>).pnl_to_close.cumsum().plot(</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>ax, label<span class="op">=</span><span class="ss">f"decile </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sharpe" class="level4">
<h4 class="anchored" data-anchor-id="sharpe">Sharpe</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df.query(<span class="ss">f"_500us_notional_os_decile == 10"</span>).pnl_to_close.copy(deep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>daily_returns <span class="op">=</span> df1.groupby(df1.index.date).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> df.query(<span class="ss">f"_500us_notional_os_decile == 10"</span>).pnl_to_close.copy(deep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>daily_returns <span class="op">=</span> df1.groupby(df1.index.date).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>daily_returns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>2021-01-04    55.462690
2021-01-05    -6.151922
2021-01-06     3.395875
2021-01-07    -0.043274
2021-01-08   -12.136896
                ...    
2021-12-27     3.808475
2021-12-28     4.436923
2021-12-29     6.358496
2021-12-30     3.419003
2021-12-31    44.445922
Name: pnl_to_close, Length: 250, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>daily_returns.mean() <span class="op">/</span> daily_returns.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.018604495611866625</code></pre>
</div>
</div>
</section>
<section id="ofis" class="level4">
<h4 class="anchored" data-anchor-id="ofis">OFIs</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>df.mid.resample(<span class="st">"5min"</span>).last().shift(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>datetime
2021-01-04 09:30:00       NaN
2021-01-04 09:35:00    67.505
2021-01-04 09:40:00    67.395
2021-01-04 09:45:00    67.250
2021-01-04 09:50:00    67.270
                        ...  
2021-12-31 15:35:00    78.050
2021-12-31 15:40:00    77.995
2021-12-31 15:45:00    78.020
2021-12-31 15:50:00    77.965
2021-12-31 15:55:00    77.705
Freq: 5T, Name: mid, Length: 104046, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>df.mid.resample(<span class="st">"5min"</span>).last()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>datetime
2021-01-04 09:30:00    67.505
2021-01-04 09:35:00    67.395
2021-01-04 09:40:00    67.250
2021-01-04 09:45:00    67.270
2021-01-04 09:50:00    67.140
                        ...  
2021-12-31 15:35:00    77.995
2021-12-31 15:40:00    78.020
2021-12-31 15:45:00    77.965
2021-12-31 15:50:00    77.705
2021-12-31 15:55:00    77.685
Freq: 5T, Name: mid, Length: 104046, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>Y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">_30S</th>
<th data-quarto-table-cell-role="th">_1min</th>
<th data-quarto-table-cell-role="th">_2min</th>
<th data-quarto-table-cell-role="th">contemp</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:35:00</td>
<td>-0.000519</td>
<td>-0.000519</td>
<td>-0.000667</td>
<td>0.001631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:40:00</td>
<td>-0.000519</td>
<td>-0.000445</td>
<td>-0.000519</td>
<td>0.002154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:45:00</td>
<td>-0.000074</td>
<td>-0.000074</td>
<td>-0.000149</td>
<td>-0.000297</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:50:00</td>
<td>-0.000074</td>
<td>-0.000074</td>
<td>-0.000149</td>
<td>0.001934</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:55:00</td>
<td>0.000670</td>
<td>0.000670</td>
<td>0.000596</td>
<td>0.001640</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:30:00</td>
<td>0.000000</td>
<td>0.000064</td>
<td>0.000128</td>
<td>0.001536</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:35:00</td>
<td>0.000064</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>0.000705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:40:00</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>0.000000</td>
<td>-0.000320</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:45:00</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>0.000705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:50:00</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>-0.000449</td>
<td>0.003340</td>
</tr>
</tbody>
</table>

<p>18426 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>np.log(<span class="fl">67.470</span>) <span class="op">-</span> np.log(<span class="fl">67.360</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.0016316847052628702</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>df.mid.resample(<span class="st">"5min"</span>).first()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>datetime
2021-01-04 09:30:00    67.695
2021-01-04 09:35:00    67.470
2021-01-04 09:40:00    67.360
2021-01-04 09:45:00    67.245
2021-01-04 09:50:00    67.265
                        ...  
2021-12-31 15:35:00    78.055
2021-12-31 15:40:00    77.990
2021-12-31 15:45:00    78.015
2021-12-31 15:50:00    77.965
2021-12-31 15:55:00    77.705
Freq: 5T, Name: mid, Length: 104046, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>Y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">_30S</th>
<th data-quarto-table-cell-role="th">_1min</th>
<th data-quarto-table-cell-role="th">_2min</th>
<th data-quarto-table-cell-role="th">contemp</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:40:00</td>
<td>-0.000519</td>
<td>-0.000445</td>
<td>-0.000519</td>
<td>-0.001631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:45:00</td>
<td>-0.000074</td>
<td>-0.000074</td>
<td>-0.000149</td>
<td>-0.002154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:50:00</td>
<td>-0.000074</td>
<td>-0.000074</td>
<td>-0.000149</td>
<td>0.000297</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:55:00</td>
<td>0.000670</td>
<td>0.000670</td>
<td>0.000596</td>
<td>-0.001934</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 10:00:00</td>
<td>0.000075</td>
<td>0.000075</td>
<td>0.000075</td>
<td>-0.001640</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:35:00</td>
<td>0.000064</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>-0.001536</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:40:00</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>0.000000</td>
<td>-0.000705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:45:00</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>0.000320</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:50:00</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>-0.000449</td>
<td>-0.000705</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:55:00</td>
<td>0.000000</td>
<td>-0.000064</td>
<td>-0.000064</td>
<td>-0.003340</td>
</tr>
</tbody>
</table>

<p>18426 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>X.sample(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ofi</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-17 12:50:00</td>
<td>0.099842</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-11-11 12:35:00</td>
<td>0.149293</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-08-18 13:25:00</td>
<td>0.537679</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-07-02 13:00:00</td>
<td>0.808090</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-04-15 09:55:00</td>
<td>0.028968</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-02-11 12:25:00</td>
<td>-0.518424</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-04-29 13:35:00</td>
<td>0.471068</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-05-06 12:30:00</td>
<td>-0.837211</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-02-26 09:55:00</td>
<td>0.379111</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-11-15 14:20:00</td>
<td>0.465241</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-05-03 15:20:00</td>
<td>0.346192</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-09-03 15:50:00</td>
<td>0.225279</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 10:30:00</td>
<td>0.048287</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-07-06 10:15:00</td>
<td>-0.019906</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-07-13 12:00:00</td>
<td>-0.447236</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-08-30 12:05:00</td>
<td>-0.393038</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-02-08 10:15:00</td>
<td>0.558504</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-04-01 14:15:00</td>
<td>0.390543</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-08 14:40:00</td>
<td>-0.361169</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-08-19 13:55:00</td>
<td>0.194927</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ofi</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:40:00</td>
<td>-0.215316</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:45:00</td>
<td>0.181602</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:50:00</td>
<td>-0.032230</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:55:00</td>
<td>0.489251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 10:00:00</td>
<td>0.701882</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:35:00</td>
<td>0.121631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:40:00</td>
<td>-0.351283</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:45:00</td>
<td>-0.159085</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:50:00</td>
<td>-0.175439</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:55:00</td>
<td>0.090304</td>
</tr>
</tbody>
</table>

<p>18426 rows × 1 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ofi</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:40:00</td>
<td>-0.215316</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:45:00</td>
<td>0.181602</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:50:00</td>
<td>-0.032230</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:55:00</td>
<td>0.489251</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 10:00:00</td>
<td>0.701882</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:35:00</td>
<td>0.121631</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:40:00</td>
<td>-0.351283</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:45:00</td>
<td>-0.159085</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:50:00</td>
<td>-0.175439</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:55:00</td>
<td>0.090304</td>
</tr>
</tbody>
</table>

<p>18426 rows × 1 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> compute_ofi(df)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.DataFrame(X)  <span class="co"># tmp fix</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> compute_log_returns(df.mid)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> restrict_common_index(X, Y)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print(X)</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(Y)</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>run_regressions(X, Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">r2</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">intercept</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">target_markout</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">_30S</td>
<td>-0.000536</td>
<td>[2.5592530391572006e-05]</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">_1min</td>
<td>-0.000504</td>
<td>[2.881596606563757e-05]</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">_2min</td>
<td>-0.000627</td>
<td>[3.1450230298814306e-05]</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">contemp</td>
<td>0.014343</td>
<td>[-0.00029700015237814586]</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.concat(</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    [compute_ofi(df.query(<span class="ss">f"_500us_notional_os_decile == </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>)],</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X.fillna(<span class="dv">0</span>)  <span class="co"># for no order flow, set 0 OFI</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>X.columns <span class="op">=</span> <span class="bu">range</span>(<span class="dv">11</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> compute_log_returns(df.mid)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> restrict_common_index(X, Y)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>run_regressions(X, Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">r2</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">intercept</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">target_markout</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">_30S</td>
<td>0.001481</td>
<td>[2.2768590911369735e-05, 2.9548178006308924e-0...</td>
<td>0.000006</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">_1min</td>
<td>0.001482</td>
<td>[2.6745891593117772e-05, 2.889654969636313e-05...</td>
<td>0.000007</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">_2min</td>
<td>0.001649</td>
<td>[2.6859770789570454e-05, 3.4577257730876217e-0...</td>
<td>0.000011</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">contemp</td>
<td>0.015877</td>
<td>[-0.0002389747605278782, -3.221983993141733e-0...</td>
<td>-0.000004</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>X.columns <span class="op">=</span> <span class="bu">range</span>(<span class="dv">11</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>run_regressions()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">datetime</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:35:00</td>
<td>-0.213995</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>NaN</td>
<td>1.000000</td>
<td>-1.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:40:00</td>
<td>-0.088624</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-0.600000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>-1.000000</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:45:00</td>
<td>0.208393</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>-1.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>NaN</td>
<td>-1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-01-04 09:50:00</td>
<td>-0.152088</td>
<td>1.000000</td>
<td>0.000000</td>
<td>-1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>1.000000</td>
<td>NaN</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-01-04 09:55:00</td>
<td>0.489251</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>NaN</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:40:00</td>
<td>-0.170790</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:45:00</td>
<td>0.069259</td>
<td>-0.373041</td>
<td>-0.666667</td>
<td>-1.000000</td>
<td>-0.987780</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>0.000000</td>
<td>-1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 15:50:00</td>
<td>0.131204</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>-1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-1.000000</td>
<td>-0.985838</td>
<td>-1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021-12-31 15:55:00</td>
<td>0.118661</td>
<td>-0.356322</td>
<td>-0.561905</td>
<td>-1.000000</td>
<td>-0.776970</td>
<td>-0.634286</td>
<td>0.324921</td>
<td>-0.673004</td>
<td>0.064639</td>
<td>-1.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021-12-31 16:00:00</td>
<td>0.034843</td>
<td>-0.090909</td>
<td>-0.702823</td>
<td>-0.693051</td>
<td>0.555556</td>
<td>NaN</td>
<td>0.855648</td>
<td>0.904123</td>
<td>-0.221790</td>
<td>0.671803</td>
<td>-0.293305</td>
</tr>
</tbody>
</table>

<p>28597 rows × 11 columns</p>
</div>
</div>
</div>
</section>
<section id="old-stuff" class="level4">
<h4 class="anchored" data-anchor-id="old-stuff">Old stuff</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>QUANTILE <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>col_name <span class="op">=</span> <span class="st">"_500us_distinct_tickers"</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>col_name_clip <span class="op">=</span> col_name <span class="op">+</span> <span class="st">"_clip"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>df[col_name_clip] <span class="op">=</span> df[col_name].clip(upper<span class="op">=</span>df[col_name].quantile(QUANTILE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>grouped_df <span class="op">=</span> (</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    df[[<span class="st">"hit_ratio"</span>, <span class="st">"pnl_to_close"</span>, col_name_clip]]</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    .groupby(by<span class="op">=</span>col_name_clip)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>        ppt_mean<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"mean"</span>),</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>        ppt_std<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"std"</span>),</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>        hit_ratio<span class="op">=</span>(<span class="st">"hit_ratio"</span>, <span class="st">"mean"</span>),</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['time', 'event', 'order_id', 'size', 'price', 'direction',
       'ask_price_1', 'bid_price_1', 'ticker', 'mid', '_250us_neighbors',
       '_500us_neighbors', '_250us_distinct_tickers_ss_bf',
       '_250us_distinct_tickers_ss_af', '_250us_distinct_tickers_os_bf',
       '_250us_distinct_tickers_os_af', '_250us_notional_ss_bf',
       '_250us_notional_ss_af', '_250us_notional_os_bf',
       '_250us_notional_os_af', '_250us_num_trades_ss_bf',
       '_250us_num_trades_ss_af', '_250us_num_trades_os_bf',
       '_250us_num_trades_os_af', '_500us_distinct_tickers_ss_bf',
       '_500us_distinct_tickers_ss_af', '_500us_distinct_tickers_os_bf',
       '_500us_distinct_tickers_os_af', '_500us_notional_ss_bf',
       '_500us_notional_ss_af', '_500us_notional_os_bf',
       '_500us_notional_os_af', '_500us_num_trades_ss_bf',
       '_500us_num_trades_ss_af', '_500us_num_trades_os_bf',
       '_500us_num_trades_os_af', 'pnl_to_close', 'hit_ratio',
       '_500us_distinct_tickers', '_500us_num_trades',
       '_500us_distinct_tickers_clip', '_500us_num_trades_clip'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>grouped_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_raio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_distinct_tickers_clip</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.620705</td>
<td>62.241559</td>
<td>0.492495</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-1.154729</td>
<td>60.229855</td>
<td>0.488880</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.983373</td>
<td>59.119667</td>
<td>0.490208</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.211530</td>
<td>61.456763</td>
<td>0.483649</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.284174</td>
<td>60.475169</td>
<td>0.499092</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>grouped_df <span class="op">=</span> (</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    df[[<span class="st">"hit_ratio"</span>, <span class="st">"pnl_to_close"</span>, col_name_clip]]</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    .groupby(by<span class="op">=</span>col_name_clip)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>        ppt_mean<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"mean"</span>),</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>        ppt_std<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"std"</span>),</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>        hit_ratio<span class="op">=</span>(<span class="st">"hit_ratio"</span>, <span class="st">"mean"</span>),</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>QUANTILE <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>col_name <span class="op">=</span> <span class="st">"_500us_num_trades"</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>col_name_clip <span class="op">=</span> col_name <span class="op">+</span> <span class="st">"_clip"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>df[col_name_clip] <span class="op">=</span> df[col_name].clip(upper<span class="op">=</span>df[col_name].quantile(QUANTILE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>grouped_df <span class="op">=</span> (</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>    df[[<span class="st">"hit_ratio"</span>, <span class="st">"pnl_to_close"</span>, col_name_clip]]</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    .groupby(by<span class="op">=</span>col_name_clip)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>        ppt_mean<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"mean"</span>),</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>        ppt_std<span class="op">=</span>(<span class="st">"pnl_to_close"</span>, <span class="st">"std"</span>),</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>        hit_ratio<span class="op">=</span>(<span class="st">"hit_ratio"</span>, <span class="st">"mean"</span>),</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>grouped_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ppt_mean</th>
<th data-quarto-table-cell-role="th">ppt_std</th>
<th data-quarto-table-cell-role="th">hit_ratio</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">_500us_num_trades_clip</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.620705</td>
<td>62.241559</td>
<td>0.492495</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.951186</td>
<td>59.917935</td>
<td>0.490033</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.552256</td>
<td>59.514261</td>
<td>0.496018</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.552811</td>
<td>59.919713</td>
<td>0.492704</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.243655</td>
<td>60.074425</td>
<td>0.485892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>-0.166191</td>
<td>58.707417</td>
<td>0.499487</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>-0.618547</td>
<td>59.863505</td>
<td>0.488867</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>-0.146460</td>
<td>60.773337</td>
<td>0.501561</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>-0.332109</td>
<td>61.497333</td>
<td>0.477329</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>-0.791676</td>
<td>60.327070</td>
<td>0.498238</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>-0.663020</td>
<td>57.377079</td>
<td>0.499149</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>-1.440645</td>
<td>61.716678</td>
<td>0.482853</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>